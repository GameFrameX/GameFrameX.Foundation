# GameFrameX.Foundation

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![.NET](https://img.shields.io/badge/.NET-10.0-purple.svg)](https://dotnet.microsoft.com/)

### ğŸ“¦ ç¨‹åºé›†æ¦‚è§ˆ

| ç¨‹åºé›†                                      | åŠŸèƒ½æè¿°          | NuGet åŒ…å                                   | ç‰ˆæœ¬                                                                                                                                                                | ä¸‹è½½æ¬¡æ•°                                                                                                                                                               |
|------------------------------------------|---------------|--------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GameFrameX.Foundation.Encryption         | åŠ å¯†å·¥å…·åº“         | `GameFrameX.Foundation.Encryption`         | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Encryption.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Encryption/)                 | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Encryption.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Encryption/)                 |
| GameFrameX.Foundation.Extensions         | æ‰©å±•æ–¹æ³•åº“         | `GameFrameX.Foundation.Extensions`         | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Extensions.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Extensions/)                 | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Extensions.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Extensions/)                 |
| GameFrameX.Foundation.Hash               | å“ˆå¸Œå·¥å…·åº“         | `GameFrameX.Foundation.Hash`               | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Hash.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Hash/)                             | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Hash.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Hash/)                             |
| GameFrameX.Foundation.Http.Extension     | HttpClient æ‰©å±• | `GameFrameX.Foundation.Http.Extension`     | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Http.Extension.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Http.Extension/)         | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Http.Extension.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Http.Extension/)         |
| GameFrameX.Foundation.Http.Normalization | HTTP æ¶ˆæ¯æ ‡å‡†åŒ–    | `GameFrameX.Foundation.Http.Normalization` | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Http.Normalization.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Http.Normalization/) | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Http.Normalization.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Http.Normalization/) |
| GameFrameX.Foundation.Json               | JSON åºåˆ—åŒ–å·¥å…·    | `GameFrameX.Foundation.Json`               | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Json.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Json/)                             | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Json.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Json/)                             |
| GameFrameX.Foundation.Localization      | æœ¬åœ°åŒ–æ¡†æ¶         | `GameFrameX.Foundation.Localization`      | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Localization.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Localization/)                 | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Localization.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Localization/)                 |
| GameFrameX.Foundation.Logger             | Serilog æ—¥å¿—é…ç½®  | `GameFrameX.Foundation.Logger`             | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Logger.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Logger/)                         | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Logger.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Logger/)                         |
| GameFrameX.Foundation.Options            | å‘½ä»¤è¡Œå‚æ•°å¤„ç†       | `GameFrameX.Foundation.Options`            | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Options.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Options/)                       | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Options.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Options/)                       |
| GameFrameX.Foundation.Orm.Attribute      | ORM ç‰¹æ€§æ ‡æ³¨      | `GameFrameX.Foundation.Orm.Attribute`      | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Orm.Attribute.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Orm.Attribute/)           | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Orm.Attribute.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Orm.Attribute/)           |
| GameFrameX.Foundation.Orm.Entity         | ORM å®ä½“åŸºç±»      | `GameFrameX.Foundation.Orm.Entity`         | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Orm.Entity.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Orm.Entity/)                 | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Orm.Entity.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Orm.Entity/)                 |
| GameFrameX.Foundation.Utility            | é€šç”¨å·¥å…·ç±»         | `GameFrameX.Foundation.Utility`            | [![NuGet](https://img.shields.io/nuget/v/GameFrameX.Foundation.Utility.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Utility/)                       | [![NuGet](https://img.shields.io/nuget/dt/GameFrameX.Foundation.Utility.svg)](https://www.nuget.org/packages/GameFrameX.Foundation.Utility/)                       |

GameFrameX çš„åŸºç¡€å·¥å…·åº“ï¼Œæä¾›äº†ä¸€ç³»åˆ—é«˜æ€§èƒ½ã€æ˜“ç”¨çš„åŸºç¡€ç»„ä»¶å’Œå·¥å…·ç±»ï¼Œæ¶µç›–åŠ å¯†ã€å“ˆå¸Œã€HTTPã€JSONã€æ—¥å¿—ç­‰å¸¸ç”¨åŠŸèƒ½ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

é€šè¿‡ NuGet åŒ…ç®¡ç†å™¨å®‰è£…æ‰€éœ€çš„ç»„ä»¶ï¼š

```bash
# å®‰è£…åŠ å¯†å·¥å…·åº“
dotnet add package GameFrameX.Foundation.Encryption

# å®‰è£…æ‰©å±•æ–¹æ³•åº“
dotnet add package GameFrameX.Foundation.Extensions

# å®‰è£…å“ˆå¸Œå·¥å…·åº“
dotnet add package GameFrameX.Foundation.Hash

# å®‰è£… JSON å·¥å…·åº“
dotnet add package GameFrameX.Foundation.Json

# å®‰è£…æœ¬åœ°åŒ–æ¡†æ¶
dotnet add package GameFrameX.Foundation.Localization

# å®‰è£…æ—¥å¿—å·¥å…·åº“
dotnet add package GameFrameX.Foundation.Logger

# å®‰è£…å‘½ä»¤è¡Œå‚æ•°å¤„ç†åº“
dotnet add package GameFrameX.Foundation.Options

# å®‰è£… HTTP æ‰©å±•
dotnet add package GameFrameX.Foundation.Http.Extension

# å®‰è£… HTTP æ¶ˆæ¯æ ‡å‡†åŒ–
dotnet add package GameFrameX.Foundation.Http.Normalization
```

### åŸºæœ¬ä½¿ç”¨

```csharp
using GameFrameX.Foundation.Encryption;
using GameFrameX.Foundation.Extensions;
using GameFrameX.Foundation.Hash;
using GameFrameX.Foundation.Json;
using GameFrameX.Foundation.Localization.Core;
using GameFrameX.Foundation.Logger;
using GameFrameX.Foundation.Options;

// AES åŠ å¯†
string encrypted = AesHelper.Encrypt("Hello World", "your-key");
string decrypted = AesHelper.Decrypt(encrypted, "your-key");

// æ‰©å±•æ–¹æ³•ä½¿ç”¨
var list = new List<int> { 1, 2, 3, 4, 5 };
var randomItem = list.Random(); // éšæœºè·å–å…ƒç´ 
var isNullOrEmpty = myString.IsNullOrEmpty(); // å­—ç¬¦ä¸²æ£€æŸ¥

// å­—ç¬¦ä¸²æ‰©å±•
string base64 = "SGVsbG8gV29ybGQ=";
string urlSafe = base64.ToUrlSafeBase64(); // URLå®‰å…¨Base64
string centered = "Hello".CenterAlignedText(20); // å±…ä¸­å¯¹é½

// å¯¹è±¡éªŒè¯
object obj = GetSomeObject();
obj.ThrowIfNull(nameof(obj)); // ç©ºå€¼æ£€æŸ¥
int value = 50;
value.CheckRange(1, 100); // èŒƒå›´æ£€æŸ¥

// é«˜æ€§èƒ½å­—èŠ‚æ“ä½œ
Span<byte> buffer = stackalloc byte[8];
int offset = 0;
buffer.WriteUIntValue(12345u, ref offset);
buffer.WriteFloatValue(3.14f, ref offset);

// åŒå‘å­—å…¸
var biDict = new BidirectionalDictionary<string, int>();
biDict.TryAdd("one", 1);
if (biDict.TryGetKey(1, out string key)) { /* åå‘æŸ¥æ‰¾ */ }

// å‘½ä»¤è¡Œå‚æ•°å¤„ç†
var builder = new OptionsBuilder<AppConfig>(args);
var config = builder.Build();

// SHA-256 å“ˆå¸Œ
string hash = Sha256Helper.ComputeHash("Hello World");

// JSON åºåˆ—åŒ–
string json = JsonHelper.Serialize(myObject);
MyClass obj = JsonHelper.Deserialize<MyClass>(json);

// æœ¬åœ°åŒ–å­—ç¬¦ä¸²è·å–
var successMessage = LocalizationService.GetString("Success");
var errorMessage = LocalizationService.GetString("Utility.Exceptions.TimestampOutOfRange");
var formattedMessage = LocalizationService.GetString("Encryption.InvalidKeySize", 128, 256);

// æ—¥å¿—è®°å½•
LogHandler.Create(LogOptions.Default);
LogHelper.Info("åº”ç”¨ç¨‹åºå¯åŠ¨");
```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

### ğŸ§© æ‰©å±•æ–¹æ³•åº“ (GameFrameX.Foundation.Extensions)

æä¾›ä¸°å¯Œçš„æ‰©å±•æ–¹æ³•é›†åˆï¼Œå¢å¼º .NET åŸºç¡€ç±»å‹çš„åŠŸèƒ½ï¼Œæé«˜å¼€å‘æ•ˆç‡å’Œä»£ç å¯è¯»æ€§ã€‚

#### æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ

| ç»„ä»¶           | æ–‡ä»¶å                                                               | ä¸»è¦åŠŸèƒ½                           |
|--------------|-------------------------------------------------------------------|--------------------------------|
| **é›†åˆæ‰©å±•**     | `CollectionExtensions.cs`                                         | ä¸ºå„ç§é›†åˆç±»å‹æä¾›ä¾¿æ·æ“ä½œæ–¹æ³•                |
| **å­—ç¬¦ä¸²æ‰©å±•**    | `StringExtensions.cs`                                             | å¢å¼ºå­—ç¬¦ä¸²å¤„ç†èƒ½åŠ›ï¼ŒåŒ…å«URLå®‰å…¨Base64ã€å±…ä¸­å¯¹é½ç­‰  |
| **å¯¹è±¡æ‰©å±•**     | `ObjectExtensions.cs`                                             | æä¾›å¯¹è±¡éªŒè¯å’Œæ•°å€¼èŒƒå›´æ£€æŸ¥                  |
| **ç±»å‹æ‰©å±•**     | `TypeExtensions.cs`                                               | ç±»å‹æ£€æŸ¥å’Œåå°„ç›¸å…³æ‰©å±•æ–¹æ³•                  |
| **æšä¸¾æ‰©å±•**     | `IEnumerableExtensions.cs`                                        | LINQ å¢å¼ºå’Œé›†åˆæ“ä½œï¼Œæ”¯æŒäº¤é›†ã€å·®é›†ç­‰          |
| **å­—å…¸æ‰©å±•**     | `IDictionaryExtensions.cs`                                        | å­—å…¸æ“ä½œå¢å¼ºï¼Œæ”¯æŒåˆå¹¶ã€æ¡ä»¶ç§»é™¤ç­‰              |
| **åˆ—è¡¨æ‰©å±•**     | `ListExtensions.cs`                                               | åˆ—è¡¨ç‰¹å®šçš„æ‰©å±•æ–¹æ³•                      |
| **å­—èŠ‚æ‰©å±•**     | `ByteExtensions.cs`                                               | å­—èŠ‚æ•°ç»„æ“ä½œï¼ŒåŒ…å«å­æ•°ç»„æå–ç­‰                |
| **Spanæ‰©å±•**   | `SpanExtensions.cs`                                               | é«˜æ€§èƒ½å†…å­˜æ“ä½œï¼Œæ”¯æŒå„ç§æ•°æ®ç±»å‹è¯»å†™ï¼ŒåŒ…å«å¤§ç«¯åºå’Œå°ç«¯åºæ”¯æŒ |
| **åªè¯»Spanæ‰©å±•** | `ReadOnlySpanExtensions.cs`                                       | åªè¯»å†…å­˜çš„é«˜æ€§èƒ½è¯»å–æ“ä½œ                   |
| **åºåˆ—è¯»å–å™¨æ‰©å±•**  | `SequenceReaderExtensions.cs`                                     | åºåˆ—æ•°æ®çš„ä¾¿æ·è¯»å–æ–¹æ³•                    |
| **åŒå‘å­—å…¸**     | `BidirectionalDictionary.cs`                                      | æ”¯æŒåŒå‘æŸ¥æ‰¾çš„å­—å…¸å®ç°                    |
| **æŸ¥æ‰¾è¡¨**      | `LookupX.cs`                                                      | å¢å¼ºçš„ä¸€å¯¹å¤šå…³ç³»æŸ¥æ‰¾è¡¨                    |
| **å¹¶å‘é˜Ÿåˆ—**     | `ConcurrentLimitedQueue.cs`                                       | çº¿ç¨‹å®‰å…¨çš„æœ‰é™å®¹é‡é˜Ÿåˆ—                    |
| **å¯ç©ºå­—å…¸**     | `NullableDictionary.cs`<br/>`NullableConcurrentDictionary.cs`     | æ”¯æŒç©ºå€¼çš„å­—å…¸å®ç°                      |
| **å¯é‡Šæ”¾å­—å…¸**    | `DisposableDictionary.cs`<br/>`DisposableConcurrentDictionary.cs` | å€¼å¯è¢«è‡ªåŠ¨é‡Šæ”¾çš„å­—å…¸                     |
| **å¸¸é‡å®šä¹‰**     | `ConstBaseTypeSize.cs`                                            | åŸºç¡€æ•°æ®ç±»å‹å­—èŠ‚å¤§å°å¸¸é‡                   |
| **ç©ºå¯¹è±¡æ¨¡å¼**    | `NullObject.cs`                                                   | ç±»å‹å®‰å…¨çš„ç©ºå¯¹è±¡å®ç°                     |
| **è‡ªå®šä¹‰å¼‚å¸¸**    | `ArgumentAlreadyException.cs`                                     | å‚æ•°å·²å­˜åœ¨å¼‚å¸¸ç±»å‹                      |

#### é›†åˆæ‰©å±•åŠŸèƒ½

```csharp
using GameFrameX.Foundation.Extensions;

// é›†åˆæ“ä½œ
var list = new List<int> { 1, 2, 3, 4, 5 };
var randomItem = list.Random(); // éšæœºè·å–å…ƒç´ 
var isEmpty = list.IsNullOrEmpty(); // æ£€æŸ¥æ˜¯å¦ä¸ºç©º

// å­—å…¸æ‰©å±•
var dict = new Dictionary<string, int>();
dict.Merge("key", 10, (old, new) => old + new); // åˆå¹¶å€¼
var value = dict.GetOrAdd("key", k => 42); // è·å–æˆ–æ·»åŠ 
dict.RemoveIf((k, v) => v > 100); // æ¡ä»¶ç§»é™¤

// HashSet æ‰©å±•
var hashSet = new HashSet<int>();
hashSet.AddRange(new[] { 1, 2, 3, 4, 5 }); // æ‰¹é‡æ·»åŠ 
```

#### å­—ç¬¦ä¸²æ‰©å±•åŠŸèƒ½

```csharp
// å­—ç¬¦ä¸²æ£€æŸ¥
string text = "Hello World";
bool isEmpty = text.IsNullOrEmpty();
bool isEmptyOrWhitespace = text.IsNullOrEmptyOrWhiteSpace();
bool hasContent = text.IsNotNullOrEmptyOrWhiteSpace();

// å­—ç¬¦ä¸²å¤„ç†
string base64 = "SGVsbG8gV29ybGQ=";
string urlSafe = base64.ToUrlSafeBase64(); // è½¬æ¢ä¸º URL å®‰å…¨æ ¼å¼
string restored = urlSafe.FromUrlSafeBase64(); // è¿˜åŸæ ‡å‡†æ ¼å¼

// å­—ç¬¦ä¸²æ“ä½œ
string centered = "Hello".CenterAlignedText(20); // å±…ä¸­å¯¹é½
string cleaned = "Hello World   ".RemoveWhiteSpace(); // ç§»é™¤ç©ºç™½å­—ç¬¦
string trimmed = "Hello!".RemoveSuffix('!'); // ç§»é™¤åç¼€

// å­—ç¬¦é‡å¤
string repeated = 'A'.RepeatChar(5); // "AAAAA"
```

#### å¯¹è±¡éªŒè¯å’ŒèŒƒå›´æ£€æŸ¥

```csharp
// ç©ºå€¼æ£€æŸ¥
object obj = GetSomeObject();
if (obj.IsNotNull())
{
    // å¯¹è±¡ä¸ä¸ºç©ºæ—¶çš„å¤„ç†
}

// å‚æ•°éªŒè¯
obj.ThrowIfNull(nameof(obj)); // ä¸ºç©ºæ—¶æŠ›å‡ºå¼‚å¸¸

// æ•°å€¼èŒƒå›´æ£€æŸ¥
int value = 50;
value.CheckRange(1, 100); // æ£€æŸ¥èŒƒå›´ï¼Œè¶…å‡ºæ—¶æŠ›å‡ºå¼‚å¸¸
bool inRange = value.IsRange(1, 100); // æ£€æŸ¥æ˜¯å¦åœ¨èŒƒå›´å†…

// æ”¯æŒå¤šç§æ•°å€¼ç±»å‹
uint uintValue = 25;
uintValue.CheckRange(0, 50);

long longValue = 1000;
longValue.CheckRange(500, 2000);
```

#### ç±»å‹æ£€æŸ¥æ‰©å±•

```csharp
// æ³›å‹æ¥å£æ£€æŸ¥
Type listType = typeof(List<string>);
Type genericListType = typeof(List<>);
bool implementsGeneric = listType.HasImplementedRawGeneric(genericListType);

// æ¥å£å®ç°æ£€æŸ¥
Type stringType = typeof(string);
Type comparableType = typeof(IComparable);
bool implementsInterface = stringType.IsImplWithInterface(comparableType);
```

#### LINQ å¢å¼ºæ‰©å±•

```csharp
// äº¤é›†æ“ä½œ
var list1 = new[] { 1, 2, 3, 4, 5 };
var list2 = new[] { 3, 4, 5, 6, 7 };
var intersection = list1.IntersectBy(list2, x => x); // æŒ‰é”®å–äº¤é›†

// å¤šé›†åˆäº¤é›†
var collections = new[] { list1, list2, new[] { 4, 5, 6 } };
var allIntersection = collections.IntersectAll(); // æ‰€æœ‰é›†åˆçš„äº¤é›†

// å·®é›†æ“ä½œ
var difference = list1.ExceptBy(list2, (x, y) => x == y);

// æ‰¹é‡æ·»åŠ 
var collection = new List<int>();
collection.AddRange(1, 2, 3, 4, 5); // ä½¿ç”¨ params å‚æ•°
collection.AddRange(new[] { 6, 7, 8 }); // ä½¿ç”¨æ•°ç»„
```

#### åŒå‘å­—å…¸

```csharp
// åˆ›å»ºåŒå‘å­—å…¸
var biDict = new BidirectionalDictionary<string, int>();

// æ·»åŠ é”®å€¼å¯¹
biDict.TryAdd("one", 1);
biDict.TryAdd("two", 2);

// åŒå‘æŸ¥æ‰¾
if (biDict.TryGetValue("one", out int value))
{
    Console.WriteLine($"Key 'one' maps to {value}");
}

if (biDict.TryGetKey(1, out string key))
{
    Console.WriteLine($"Value 1 maps to '{key}'");
}

// æ¸…ç©ºå­—å…¸
biDict.Clear();
```

#### é«˜æ€§èƒ½æ‰©å±•

```csharp
// Span å’Œ ReadOnlySpan æ‰©å±•
ReadOnlySpan<byte> span = stackalloc byte[] { 1, 2, 3, 4, 5 };
// æä¾›é’ˆå¯¹ Span çš„é«˜æ€§èƒ½æ“ä½œæ‰©å±•

// åºåˆ—è¯»å–å™¨æ‰©å±•
// ä¸º SequenceReader æä¾›ä¾¿æ·çš„è¯»å–æ–¹æ³•
```

#### å­—èŠ‚æ“ä½œæ‰©å±•

```csharp
// å­—èŠ‚æ•°ç»„æ‰©å±•
byte[] data = { 1, 2, 3, 4, 5 };
byte[] subArray = data.SubArray(1, 3); // è·å–å­æ•°ç»„

// Span å’Œ ReadOnlySpan æ‰©å±• - é«˜æ€§èƒ½å­—èŠ‚æ“ä½œ
Span<byte> buffer = stackalloc byte[16];
int offset = 0;

// å†™å…¥å„ç§æ•°æ®ç±»å‹ï¼ˆæ”¯æŒå¤§ç«¯åºå’Œå°ç«¯åºï¼‰
buffer.WriteUIntValue(12345u, ref offset);
buffer.WriteFloatValue(3.14f, ref offset);
buffer.WriteUIntBigEndianValue(12345u, ref offset); // å¤§ç«¯åºå†™å…¥
buffer.WriteFloatBigEndianValue(3.14f, ref offset); // å¤§ç«¯åºå†™å…¥

// è¯»å–æ•°æ®ç±»å‹
offset = 0;
uint value = buffer.ReadUIntValue(ref offset);
float floatValue = buffer.ReadFloatValue(ref offset);
uint bigEndianValue = buffer.ReadUIntBigEndianValue(ref offset); // å¤§ç«¯åºè¯»å–

// ReadOnlySpan è¯»å–æ“ä½œ
ReadOnlySpan<byte> readBuffer = buffer;
offset = 0;
uint readValue = readBuffer.ReadUIntValue(ref offset);
float readFloatValue = readBuffer.ReadFloatBigEndianValue(ref offset);
```

#### åºåˆ—è¯»å–å™¨æ‰©å±•

```csharp
// ä¸º SequenceReader æä¾›ä¾¿æ·çš„è¯»å–æ–¹æ³•
// æ”¯æŒå¸¦é•¿åº¦å‰ç¼€çš„å­—èŠ‚æ•°ç»„è¯»å–
// æä¾› TryPeek æ–¹æ³•è¿›è¡Œéç ´åæ€§è¯»å–
```

#### ç‰¹æ®Šå·¥å…·ç±»

- **ConstBaseTypeSize**: åŸºç¡€æ•°æ®ç±»å‹å­—èŠ‚å¤§å°å¸¸é‡å®šä¹‰ï¼ŒåŒ…å«æ‰€æœ‰.NETåŸºç¡€ç±»å‹çš„å­—èŠ‚å¤§å°
- **NullObject**: ç©ºå¯¹è±¡æ¨¡å¼å®ç°ï¼Œæä¾›ç±»å‹å®‰å…¨çš„ç©ºå¯¹è±¡
- **NullableConcurrentDictionary**: æ”¯æŒç©ºå€¼çš„çº¿ç¨‹å®‰å…¨å¹¶å‘å­—å…¸
- **NullableDictionary**: æ”¯æŒç©ºå€¼çš„æ™®é€šå­—å…¸
- **LookupX**: å¢å¼ºçš„æŸ¥æ‰¾è¡¨å®ç°ï¼Œæ”¯æŒä¸€å¯¹å¤šå…³ç³»æ˜ å°„
- **ArgumentAlreadyException**: å‚æ•°å·²å­˜åœ¨å¼‚å¸¸ï¼Œç”¨äºå‚æ•°éªŒè¯åœºæ™¯
- **ConcurrentLimitedQueue**: çº¿ç¨‹å®‰å…¨çš„æœ‰é™å®¹é‡é˜Ÿåˆ—ï¼Œè‡ªåŠ¨ç§»é™¤æœ€æ—§å…ƒç´ 
- **DisposableConcurrentDictionary/DisposableDictionary**: å€¼å¯è¢«è‡ªåŠ¨é‡Šæ”¾çš„å­—å…¸ç±»å‹

### ğŸ” åŠ å¯†å·¥å…·åº“ (GameFrameX.Foundation.Encryption)

æä¾›å¤šç§åŠ å¯†ç®—æ³•çš„å®ç°ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ä¼ è¾“å’Œå­˜å‚¨ã€‚

#### æ”¯æŒçš„ç®—æ³•

- **AES åŠ å¯†** (`AesHelper`): å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ”¯æŒå­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°ç»„
- **RSA åŠ å¯†** (`RsaHelper`): éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ”¯æŒå¯†é’¥å¯¹ç”Ÿæˆã€åŠ å¯†è§£å¯†ã€æ•°å­—ç­¾å
- **DSA ç­¾å** (`DsaHelper`): æ•°å­—ç­¾åç®—æ³•ï¼Œæ”¯æŒç­¾åå’ŒéªŒè¯
- **SM2/SM4 åŠ å¯†** (`Sm2Helper`/`Sm4Helper`): å›½å¯†ç®—æ³•å®ç°
    - SM2: éå¯¹ç§°åŠ å¯†ç®—æ³•
    - SM4: å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ”¯æŒ ECB/CBC æ¨¡å¼
- **XOR åŠ å¯†** (`XorHelper`): å¼‚æˆ–åŠ å¯†ï¼Œæ”¯æŒå¿«é€ŸåŠ å¯†å’Œå®Œæ•´åŠ å¯†æ¨¡å¼

#### ä½¿ç”¨ç¤ºä¾‹

```csharp
// AES åŠ å¯†
string encrypted = AesHelper.Encrypt("æ•æ„Ÿæ•°æ®", "your-secret-key");
string decrypted = AesHelper.Decrypt(encrypted, "your-secret-key");

// RSA åŠ å¯†
var keys = RsaHelper.Make();
string encrypted = RsaHelper.Encrypt(keys["publicKey"], "Hello World");
string decrypted = RsaHelper.Decrypt(keys["privateKey"], encrypted);

// SM4 åŠ å¯†
string encrypted = Sm4Helper.EncryptCbc("your-key", "Hello World");
string decrypted = Sm4Helper.DecryptCbc("your-key", encrypted);
```

### ğŸ”— å“ˆå¸Œå·¥å…·åº“ (GameFrameX.Foundation.Hash)

æä¾›å¤šç§å“ˆå¸Œç®—æ³•å®ç°ï¼Œé€‚ç”¨äºæ•°æ®å®Œæ•´æ€§æ ¡éªŒã€å¿«é€ŸæŸ¥æ‰¾ç­‰åœºæ™¯ã€‚

#### æ”¯æŒçš„ç®—æ³•

- **MD5** (`Md5Helper`): 128ä½å“ˆå¸Œå€¼ï¼Œæ”¯æŒåŠ ç›
- **SHA ç³»åˆ—**:
    - SHA-1 (`Sha1Helper`): 160ä½å“ˆå¸Œå€¼
    - SHA-256 (`Sha256Helper`): 256ä½å“ˆå¸Œå€¼
    - SHA-512 (`Sha512Helper`): 512ä½å“ˆå¸Œå€¼
- **HMAC-SHA256** (`HmacSha256Helper`): åŸºäºå¯†é’¥çš„æ¶ˆæ¯è®¤è¯ç 
- **CRC æ ¡éªŒ** (`CrcHelper`): CRC32/CRC64 å¾ªç¯å†—ä½™æ ¡éªŒ
- **MurmurHash3** (`MurmurHash3Helper`): é«˜æ€§èƒ½éåŠ å¯†å“ˆå¸Œ
- **xxHash** (`XxHashHelper`): è¶…é«˜æ€§èƒ½å“ˆå¸Œç®—æ³•ï¼Œæ”¯æŒ32/64/128ä½

#### ä½¿ç”¨ç¤ºä¾‹

```csharp
// MD5 å“ˆå¸Œ
string md5Hash = Md5Helper.Hash("Hello World");
string saltedHash = Md5Helper.HashWithSalt("Hello World", "salt");

// SHA-256 å“ˆå¸Œ
string sha256Hash = Sha256Helper.ComputeHash("Hello World");

// HMAC-SHA256
string hmacHash = HmacSha256Helper.Hash("message", "secret-key");

// xxHash (é«˜æ€§èƒ½)
ulong xxHash = XxHashHelper.Hash64("Hello World");
```

### ğŸŒ HTTP å·¥å…·åº“

#### HTTP æ‰©å±• (GameFrameX.Foundation.Http.Extension)

ä¸º HttpClient æä¾›ä¾¿æ·çš„æ‰©å±•æ–¹æ³•ï¼Œç®€åŒ– JSON æ•°æ®çš„å‘é€å’Œæ¥æ”¶ã€‚

```csharp
// POST JSON è¯·æ±‚
string response = await httpClient.PostJsonToStringAsync<MyClass>(url, myObject);
```

#### HTTP æ¶ˆæ¯æ ‡å‡†åŒ– (GameFrameX.Foundation.Http.Normalization)

æä¾›ç»Ÿä¸€çš„ HTTP å“åº”æ ¼å¼ï¼ŒåŒ…å« `code`ã€`message` å’Œ `data` å­—æ®µï¼Œé€‚ç”¨äº GameFrameX ç”Ÿæ€ç³»ç»Ÿã€‚

### ğŸ“„ JSON åºåˆ—åŒ– (GameFrameX.Foundation.Json)

åŸºäº `System.Text.Json` çš„é«˜æ€§èƒ½åºåˆ—åŒ–å·¥å…·ï¼Œæä¾›ä¼˜åŒ–çš„é»˜è®¤é…ç½®ã€‚

#### ç‰¹æ€§

- é«˜æ€§èƒ½åºåˆ—åŒ–/ååºåˆ—åŒ–
- æšä¸¾åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²
- å¿½ç•¥ null å€¼å±æ€§
- å¿½ç•¥å¾ªç¯å¼•ç”¨
- å±æ€§åç§°å¤§å°å†™ä¸æ•æ„Ÿ
- æä¾›æ ¼å¼åŒ–å’Œç´§å‡‘ä¸¤ç§è¾“å‡ºæ¨¡å¼

#### ä½¿ç”¨ç¤ºä¾‹

```csharp
// åºåˆ—åŒ–
string json = JsonHelper.Serialize(myObject);
string formattedJson = JsonHelper.Serialize(myObject, JsonHelper.FormatOptions);

// ååºåˆ—åŒ–
MyClass obj = JsonHelper.Deserialize<MyClass>(json);

// å®‰å…¨çš„ååºåˆ—åŒ–
if (JsonHelper.TryDeserialize<MyClass>(json, out var result))
{
    // å¤„ç†ç»“æœ
}
```

### ğŸŒ æœ¬åœ°åŒ–æ¡†æ¶ (GameFrameX.Foundation.Localization)

æä¾›è½»é‡çº§ã€é«˜æ€§èƒ½çš„æœ¬åœ°åŒ–è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒé›¶é…ç½®ä½¿ç”¨å’Œæ‡’åŠ è½½æœºåˆ¶ï¼Œä¸ºæ•´ä¸ª GameFrameX.Foundation ç”Ÿæ€ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„æœ¬åœ°åŒ–æ”¯æŒã€‚

#### ä¸»è¦ç‰¹æ€§

- **é›¶é…ç½®ä½¿ç”¨**: æ— éœ€ä»»ä½•åˆå§‹åŒ–é…ç½®ï¼Œè‡ªåŠ¨å‘ç°å’ŒåŠ è½½æœ¬åœ°åŒ–èµ„æº
- **æ‡’åŠ è½½æœºåˆ¶**: é¦–æ¬¡ä½¿ç”¨æ—¶æ‰åŠ è½½èµ„æºï¼Œå¯åŠ¨æ€§èƒ½ä¼˜å¼‚
- **å¤šè¯­è¨€æ”¯æŒ**: å†…ç½®ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰å’Œè‹±æ–‡æ”¯æŒï¼Œå¯æ‰©å±•æ›´å¤šè¯­è¨€
- **çº¿ç¨‹å®‰å…¨**: æ”¯æŒå¹¶å‘è®¿é—®ï¼Œé€‚ç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒ
- **é«˜åº¦å¯æ‰©å±•**: æ”¯æŒè‡ªå®šä¹‰èµ„æºæä¾›è€…ï¼Œçµæ´»çš„ä¼˜å…ˆçº§ç®¡ç†
- **ä¼˜å…ˆçº§è§£æ**: è‡ªå®šä¹‰æä¾›è€… > ç¨‹åºé›†èµ„æº > é»˜è®¤èµ„æº

#### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶å | åŠŸèƒ½ |
|------|--------|------|
| **æœ¬åœ°åŒ–æœåŠ¡** | `LocalizationService.cs` | ç»Ÿä¸€çš„æœ¬åœ°åŒ–å…¥å£ç‚¹ï¼Œæä¾›é™æ€æ–¹æ³•API |
| **èµ„æºç®¡ç†å™¨** | `ResourceManager.cs` | ç®¡ç†å¤šä¸ªèµ„æºæä¾›è€…ï¼Œå®ç°ä¼˜å…ˆçº§è§£æ |
| **é»˜è®¤æä¾›è€…** | `DefaultResourceProvider.cs` | æä¾›è‹±æ–‡é»˜è®¤æ¶ˆæ¯ï¼ŒåŒ…å«50+å¸¸ç”¨æ¶ˆæ¯ |
| **ç¨‹åºé›†æä¾›è€…** | `AssemblyResourceProvider.cs` | ä».resxæ–‡ä»¶åŠ è½½æœ¬åœ°åŒ–èµ„æº |

#### åŸºç¡€ä½¿ç”¨

```csharp
using GameFrameX.Foundation.Localization.Core;

// è·å–ç®€å•çš„æœ¬åœ°åŒ–å­—ç¬¦ä¸²
var successMessage = LocalizationService.GetString("Success");
Console.WriteLine(successMessage); // æ ¹æ®å½“å‰æ–‡åŒ–æ˜¾ç¤º "Success" æˆ– "æˆåŠŸ"

// å¸¦å‚æ•°çš„æ ¼å¼åŒ–æ¶ˆæ¯
var errorMessage = LocalizationService.GetString("ArgumentNull", "username");
Console.WriteLine(errorMessage); // "Value cannot be null. (Parameter 'username')"

// å¦‚æœé”®ä¸å­˜åœ¨ï¼Œè¿”å›é”®åæœ¬èº«
var unknown = LocalizationService.GetString("Some.Unknown.Key");
Console.WriteLine(unknown); // è¾“å‡º: "Some.Unknown.Key"
```

#### å¼‚å¸¸å¤„ç†ä¸­çš„æœ¬åœ°åŒ–

```csharp
using GameFrameX.Foundation.Utility.Localization;

public class UserService
{
    public void ValidateUserInput(string input)
    {
        if (string.IsNullOrEmpty(input))
        {
            throw new ArgumentException(
                LocalizationService.GetString(LocalizationKeys.Exceptions.TimestampOutOfRange),
                nameof(input));
        }

        // å…¶ä»–éªŒè¯é€»è¾‘...
    }
}
```

#### æ¨¡å—é›†æˆæœ¬åœ°åŒ–

##### 1. å®šä¹‰æœ¬åœ°åŒ–é”®

```csharp
// YourModule/Localization/Keys.cs
namespace GameFrameX.Foundation.YourModule.Localization;

public static class LocalizationKeys
{
    public static class Validation
    {
        public const string EmailRequired = "YourModule.Validation.EmailRequired";
        public const string EmailInvalid = "YourModule.Validation.EmailInvalid";
    }

    public static class Messages
    {
        public const string UserCreated = "YourModule.Messages.UserCreated";
        public const string OperationFailed = "YourModule.Messages.OperationFailed";
    }
}
```

##### 2. åˆ›å»ºèµ„æºæ–‡ä»¶

åœ¨é¡¹ç›®ä¸­åˆ›å»º `Localization/Messages/Resources.resx` å’Œ `Localization/Messages/Resources.zh-CN.resx`ï¼š

```xml
<!-- Resources.resx (é»˜è®¤è‹±æ–‡) -->
<root>
  <data name="YourModule.Validation.EmailRequired" xml:space="preserve">
    <value>Email address is required</value>
  </data>
  <data name="YourModule.Messages.UserCreated" xml:space="preserve">
    <value>User '{0}' has been created successfully</value>
  </data>
</root>
```

```xml
<!-- Resources.zh-CN.resx (ä¸­æ–‡) -->
<root>
  <data name="YourModule.Validation.EmailRequired" xml:space="preserve">
    <value>é‚®ç®±åœ°å€æ˜¯å¿…å¡«é¡¹</value>
  </data>
  <data name="YourModule.Messages.UserCreated" xml:space="preserve">
    <value>ç”¨æˆ· '{0}' å·²æˆåŠŸåˆ›å»º</value>
  </data>
</root>
```

##### 3. åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ä½¿ç”¨

```csharp
using GameFrameX.Foundation.Localization.Core;
using GameFrameX.Foundation.YourModule.Localization;

public class UserService
{
    public void CreateUser(UserDto userDto)
    {
        if (string.IsNullOrEmpty(userDto.Email))
        {
            throw new ValidationException(
                LocalizationService.GetString(LocalizationKeys.Validation.EmailRequired));
        }

        // åˆ›å»ºç”¨æˆ·é€»è¾‘...

        var successMessage = LocalizationService.GetString(
            LocalizationKeys.Messages.UserCreated, userDto.Username);
        Console.WriteLine(successMessage);
    }
}
```

#### è‡ªå®šä¹‰èµ„æºæä¾›è€…

```csharp
public class DatabaseResourceProvider : IResourceProvider
{
    private readonly IDbConnection _connection;

    public DatabaseResourceProvider(IDbConnection connection)
    {
        _connection = connection;
    }

    public string GetString(string key)
    {
        var culture = CultureInfo.CurrentCulture.Name;
        var sql = "SELECT localized_text FROM localization_strings WHERE key = @key AND culture = @culture";
        return _connection.ExecuteScalar<string>(sql, new { key, culture });
    }
}

// æ³¨å†Œè‡ªå®šä¹‰æä¾›è€…ï¼ˆå…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼‰
var dbProvider = new DatabaseResourceProvider(yourDbConnection);
LocalizationService.RegisterProvider(dbProvider);
```

#### é¢„åŠ è½½å’Œæ€§èƒ½ä¼˜åŒ–

```csharp
// åº”ç”¨å¯åŠ¨æ—¶é¢„åŠ è½½æ‰€æœ‰æœ¬åœ°åŒ–èµ„æºï¼ˆå¯é€‰ï¼‰
LocalizationService.EnsureLoaded();

// è·å–æœ¬åœ°åŒ–ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯
var stats = LocalizationService.GetStatistics();
Console.WriteLine($"æä¾›è€…å·²åŠ è½½: {stats.ProvidersLoaded}");
Console.WriteLine($"æ€»æä¾›è€…æ•°é‡: {stats.TotalProviderCount}");
Console.WriteLine($"ç¨‹åºé›†æä¾›è€…æ•°é‡: {stats.AssemblyProviderCount}");

// è·å–æ‰€æœ‰æä¾›è€…ä¿¡æ¯
var providers = LocalizationService.GetProviders();
foreach (var provider in providers)
{
    Console.WriteLine($"æä¾›è€…: {provider.GetType().Name}");
}
```

#### èµ„æºå‘½åçº¦å®š

- **æ¨¡å¼**: `{æ¨¡å—å}.{ç±»åˆ«}.{å…·ä½“é”®å}`
- **ç¤ºä¾‹**:
  - `Utility.Exceptions.TimestampOutOfRange`
  - `Encryption.InvalidKeySize`
  - `Authentication.UserNotFound`
  - `Success`
  - `ArgumentNull`

#### å·²é›†æˆçš„æ¨¡å—

ç›®å‰ä»¥ä¸‹æ¨¡å—å·²å®Œæˆæœ¬åœ°åŒ–é›†æˆï¼š

| æ¨¡å— | æœ¬åœ°åŒ–é”®æ•°é‡ | çŠ¶æ€ |
|------|-------------|------|
| GameFrameX.Foundation.Utility | 4 | âœ… å®Œæˆ |
| GameFrameX.Foundation.Encryption | 20+ | âœ… å®Œæˆ |
| GameFrameX.Foundation.Extensions | 7 | âœ… å®Œæˆ |
| GameFrameX.Foundation.Hash | 2 | âœ… å®Œæˆ |

#### é«˜çº§åŠŸèƒ½

##### åŠ¨æ€è¯­è¨€åˆ‡æ¢

```csharp
public void SwitchLanguage(string cultureCode)
{
    Thread.CurrentThread.CurrentUICulture = new CultureInfo(cultureCode);
    Thread.CurrentThread.CurrentCulture = new CultureInfo(cultureCode);

    // å¯é€‰ï¼šé¢„åŠ è½½æ–°è¯­è¨€çš„èµ„æº
    LocalizationService.EnsureLoaded();
}
```

##### ç›‘æ§å’Œè¯Šæ–­

```csharp
public class LocalizationDiagnostics
{
    public void PrintStatus()
    {
        var stats = LocalizationService.GetStatistics();
        Console.WriteLine("=== æœ¬åœ°åŒ–ç³»ç»ŸçŠ¶æ€ ===");
        Console.WriteLine($"æä¾›è€…å·²åŠ è½½: {stats.ProvidersLoaded}");
        Console.WriteLine($"æ€»æä¾›è€…æ•°é‡: {stats.TotalProviderCount}");

        var providers = LocalizationService.GetProviders();
        foreach (var provider in providers)
        {
            Console.WriteLine($"- {provider.GetType().Name}");
        }
    }
}
```

#### æœ€ä½³å®è·µ

1. **é”®å‘½åè§„èŒƒ**: ä½¿ç”¨ `{æ¨¡å—å}.{ç±»åˆ«}.{å…·ä½“é”®å}` çš„å‘½åæ¨¡å¼
2. **å‚æ•°åŒ–æ¶ˆæ¯**: ä½¿ç”¨ `string.Format` æ ¼å¼æ”¯æŒå‚æ•°æ›¿æ¢
3. **å¼‚å¸¸å¤„ç†**: åœ¨å¼‚å¸¸æ¶ˆæ¯ä¸­é›†æˆæœ¬åœ°åŒ–æ”¯æŒ
4. **æ€§èƒ½ä¼˜åŒ–**: åº”ç”¨å¯åŠ¨æ—¶å¯é€‰æ‹©é¢„åŠ è½½èµ„æº
5. **æµ‹è¯•éªŒè¯**: ä¸ºæœ¬åœ°åŒ–åŠŸèƒ½ç¼–å†™å•å…ƒæµ‹è¯•

#### é…ç½®é¡¹ç›®æ–‡ä»¶

ç¡®ä¿é¡¹ç›®æ–‡ä»¶åŒ…å«æœ¬åœ°åŒ–èµ„æºæ–‡ä»¶ï¼š

```xml
<PropertyGroup>
  <EnableDefaultEmbeddedResourceItems>false</EnableDefaultEmbeddedResourceItems>
</PropertyGroup>

<ItemGroup>
  <EmbeddedResource Include="Localization\Messages\*.resx" />
</ItemGroup>
```

æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒï¼š
- [æœ¬åœ°åŒ–æ¡†æ¶å®Œæ•´æ–‡æ¡£](GameFrameX.Foundation.Localization/README.Localization.md)
- [ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ](GameFrameX.Foundation.Localization/USAGE_EXAMPLES.md)

### ï¿½ï¸ ORM å®ä½“åŸºç±» (GameFrameX.Foundation.Orm.Entity)

æä¾›ORMæ¡†æ¶çš„å®ä½“åŸºç±»å’Œæ¥å£å®šä¹‰ï¼Œæ”¯æŒå®¡è®¡è·Ÿè¸ªã€è½¯åˆ é™¤ã€ä¹è§‚é”ç­‰ä¼ä¸šçº§åŠŸèƒ½ã€‚

#### æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ

| ç»„ä»¶           | æ–‡ä»¶å                   | ä¸»è¦åŠŸèƒ½                          |
|--------------|-----------------------|-------------------------------|
| **å®ä½“åŸºç±»**     | `EntityBase.cs`       | å®Œæ•´åŠŸèƒ½çš„å®ä½“åŸºç±»ï¼ŒåŒ…å«IDã€å®¡è®¡ã€è½¯åˆ é™¤ã€ç‰ˆæœ¬æ§åˆ¶ç­‰åŠŸèƒ½ |
| **å®ä½“åŸºç±»(æ³›å‹)** | `EntityBaseId.cs`     | æ”¯æŒè‡ªå®šä¹‰ä¸»é”®ç±»å‹çš„å®ä½“åŸºç±»                |
| **å®ä½“æ¥å£**     | `IEntity.cs`          | åŸºç¡€å®ä½“æ¥å£å®šä¹‰ï¼Œæä¾›IDå±æ€§               |
| **å®¡è®¡æ¥å£**     | `IAuditableEntity.cs` | å®¡è®¡åŠŸèƒ½æ¥å£ï¼Œå®šä¹‰åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€æ“ä½œç”¨æˆ·ç­‰å®¡è®¡å­—æ®µ  |

#### å®ä½“åŸºç±»åŠŸèƒ½

```csharp
using GameFrameX.Foundation.Orm.Entity;

// ç»§æ‰¿EntityBaseçš„å®ä½“ç±»è‡ªåŠ¨è·å¾—å®Œæ•´çš„ä¼ä¸šçº§åŠŸèƒ½
public class User : EntityBase
{
    public string Username { get; set; }
    public string Email { get; set; }
    public string PasswordHash { get; set; }
    
    // ä»¥ä¸‹å±æ€§ç”±EntityBaseæä¾›ï¼š
    // - long Id                    // ä¸»é”®ID
    // - DateTime CreateTime        // åˆ›å»ºæ—¶é—´
    // - DateTime UpdateTime        // æ›´æ–°æ—¶é—´
    // - long CreateUserId          // åˆ›å»ºç”¨æˆ·ID
    // - long UpdateUserId          // æ›´æ–°ç”¨æˆ·ID
    // - string CreateUserName      // åˆ›å»ºç”¨æˆ·å
    // - string UpdateUserName      // æ›´æ–°ç”¨æˆ·å
    // - bool IsDelete              // è½¯åˆ é™¤æ ‡è®°
    // - long Version               // ä¹è§‚é”ç‰ˆæœ¬å·
    // - bool IsEnabled             // å¯ç”¨çŠ¶æ€
}

// ä½¿ç”¨ç¤ºä¾‹
var user = new User
{
    Username = "john_doe",
    Email = "john@example.com",
    PasswordHash = "hashed_password",
    CreateTime = DateTime.UtcNow,
    CreateUserId = 1,
    CreateUserName = "admin",
    IsEnabled = true
};
```

#### è‡ªå®šä¹‰ä¸»é”®ç±»å‹

```csharp
using GameFrameX.Foundation.Orm.Entity;

// ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºä¸»é”®
public class Product : EntityBaseId<string>
{
    public string Name { get; set; }
    public decimal Price { get; set; }
    public string Description { get; set; }
    
    // Idå±æ€§ç±»å‹ä¸ºstringï¼Œç”±EntityBaseId<string>æä¾›
}

// ä½¿ç”¨Guidä½œä¸ºä¸»é”®
public class Order : EntityBaseId<Guid>
{
    public string OrderNumber { get; set; }
    public decimal TotalAmount { get; set; }
    public DateTime OrderDate { get; set; }
    
    // Idå±æ€§ç±»å‹ä¸ºGuidï¼Œç”±EntityBaseId<Guid>æä¾›
}

// ä½¿ç”¨ç¤ºä¾‹
var product = new Product
{
    Id = "PROD-001",
    Name = "ç¬”è®°æœ¬ç”µè„‘",
    Price = 5999.99m,
    Description = "é«˜æ€§èƒ½ç¬”è®°æœ¬ç”µè„‘"
};

var order = new Order
{
    Id = Guid.NewGuid(),
    OrderNumber = "ORD-20240101-001",
    TotalAmount = 5999.99m,
    OrderDate = DateTime.UtcNow
};
```

#### æ¥å£å®ç°

```csharp
using GameFrameX.Foundation.Orm.Entity;

// å®ç°åŸºç¡€å®ä½“æ¥å£
public class Category : IEntity<int>
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
}

// å®ç°å®¡è®¡æ¥å£
public class AuditableCategory : IEntity<int>, IAuditableEntity
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    
    // IAuditableEntityæ¥å£è¦æ±‚çš„å±æ€§
    public DateTime CreateTime { get; set; }
    public DateTime UpdateTime { get; set; }
    public long CreateUserId { get; set; }
    public long UpdateUserId { get; set; }
    public string CreateUserName { get; set; }
    public string UpdateUserName { get; set; }
}
```

#### ä¼ä¸šçº§åŠŸèƒ½è¯¦è§£

##### 1. å®¡è®¡è·Ÿè¸ª (Audit Trail)

```csharp
// EntityBaseè‡ªåŠ¨æä¾›å®¡è®¡å­—æ®µ
public class Document : EntityBase
{
    public string Title { get; set; }
    public string Content { get; set; }
}

// åœ¨ä¸šåŠ¡é€»è¾‘ä¸­è®¾ç½®å®¡è®¡ä¿¡æ¯
var document = new Document
{
    Title = "é‡è¦æ–‡æ¡£",
    Content = "æ–‡æ¡£å†…å®¹...",
    CreateTime = DateTime.UtcNow,
    CreateUserId = currentUser.Id,
    CreateUserName = currentUser.Username,
    UpdateTime = DateTime.UtcNow,
    UpdateUserId = currentUser.Id,
    UpdateUserName = currentUser.Username
};

// æ›´æ–°æ—¶è‡ªåŠ¨ç»´æŠ¤å®¡è®¡ä¿¡æ¯
document.Content = "æ›´æ–°åçš„å†…å®¹";
document.UpdateTime = DateTime.UtcNow;
document.UpdateUserId = currentUser.Id;
document.UpdateUserName = currentUser.Username;
document.Version++; // ä¹è§‚é”ç‰ˆæœ¬é€’å¢
```

##### 2. è½¯åˆ é™¤ (Soft Delete)

```csharp
// è½¯åˆ é™¤ï¼šä¸çœŸæ­£åˆ é™¤è®°å½•ï¼Œè€Œæ˜¯æ ‡è®°ä¸ºå·²åˆ é™¤
public void SoftDeleteUser(User user)
{
    user.IsDelete = true;
    user.UpdateTime = DateTime.UtcNow;
    user.UpdateUserId = currentUser.Id;
    user.UpdateUserName = currentUser.Username;
    
    // ä¿å­˜åˆ°æ•°æ®åº“ï¼Œè®°å½•ä»ç„¶å­˜åœ¨ä½†è¢«æ ‡è®°ä¸ºå·²åˆ é™¤
    dbContext.SaveChanges();
}

// æŸ¥è¯¢æ—¶è¿‡æ»¤å·²åˆ é™¤çš„è®°å½•
var activeUsers = dbContext.Users
    .Where(u => !u.IsDelete)
    .ToList();

// æ¢å¤å·²åˆ é™¤çš„è®°å½•
public void RestoreUser(User user)
{
    user.IsDelete = false;
    user.UpdateTime = DateTime.UtcNow;
    user.UpdateUserId = currentUser.Id;
    user.UpdateUserName = currentUser.Username;
    
    dbContext.SaveChanges();
}
```

##### 3. ä¹è§‚é” (Optimistic Locking)

```csharp
// ä½¿ç”¨Versionå­—æ®µå®ç°ä¹è§‚é”
public void UpdateUserWithOptimisticLock(long userId, string newEmail)
{
    var user = dbContext.Users.Find(userId);
    if (user == null) throw new EntityNotFoundException();
    
    var originalVersion = user.Version;
    
    // ä¿®æ”¹æ•°æ®
    user.Email = newEmail;
    user.UpdateTime = DateTime.UtcNow;
    user.UpdateUserId = currentUser.Id;
    user.UpdateUserName = currentUser.Username;
    user.Version++; // ç‰ˆæœ¬å·é€’å¢
    
    try
    {
        // ä¿å­˜æ—¶æ£€æŸ¥ç‰ˆæœ¬å·
        var rowsAffected = dbContext.Database.ExecuteSqlRaw(
            "UPDATE Users SET Email = {0}, UpdateTime = {1}, UpdateUserId = {2}, UpdateUserName = {3}, Version = {4} " +
            "WHERE Id = {5} AND Version = {6}",
            user.Email, user.UpdateTime, user.UpdateUserId, user.UpdateUserName, user.Version, user.Id, originalVersion);
            
        if (rowsAffected == 0)
        {
            throw new ConcurrencyException("æ•°æ®å·²è¢«å…¶ä»–ç”¨æˆ·ä¿®æ”¹ï¼Œè¯·åˆ·æ–°åé‡è¯•");
        }
    }
    catch (DbUpdateConcurrencyException)
    {
        throw new ConcurrencyException("å¹¶å‘å†²çªï¼Œè¯·åˆ·æ–°åé‡è¯•");
    }
}
```

##### 4. å¯ç”¨çŠ¶æ€ç®¡ç†

```csharp
// ä½¿ç”¨IsEnabledå­—æ®µç®¡ç†å®ä½“çš„å¯ç”¨çŠ¶æ€
public class Feature : EntityBase
{
    public string Name { get; set; }
    public string Description { get; set; }
    // IsEnabledç”±EntityBaseæä¾›
}

// å¯ç”¨/ç¦ç”¨åŠŸèƒ½
public void ToggleFeature(long featureId, bool enabled)
{
    var feature = dbContext.Features.Find(featureId);
    if (feature == null) throw new EntityNotFoundException();
    
    feature.IsEnabled = enabled;
    feature.UpdateTime = DateTime.UtcNow;
    feature.UpdateUserId = currentUser.Id;
    feature.UpdateUserName = currentUser.Username;
    feature.Version++;
    
    dbContext.SaveChanges();
}

// æŸ¥è¯¢å¯ç”¨çš„åŠŸèƒ½
var enabledFeatures = dbContext.Features
    .Where(f => f.IsEnabled && !f.IsDelete)
    .ToList();
```

#### å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

```csharp
using GameFrameX.Foundation.Orm.Entity;
using Microsoft.EntityFrameworkCore;

namespace MyApplication.Entities
{
    // ç”¨æˆ·å®ä½“
    public class User : EntityBase
    {
        public string Username { get; set; }
        public string Email { get; set; }
        public string PasswordHash { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public DateTime? LastLoginTime { get; set; }
        
        // å¯¼èˆªå±æ€§
        public virtual ICollection<Order> Orders { get; set; }
        public virtual ICollection<UserRole> UserRoles { get; set; }
    }
    
    // è®¢å•å®ä½“ï¼ˆä½¿ç”¨Guidä¸»é”®ï¼‰
    public class Order : EntityBaseId<Guid>
    {
        public string OrderNumber { get; set; }
        public long UserId { get; set; }
        public decimal TotalAmount { get; set; }
        public DateTime OrderDate { get; set; }
        public OrderStatus Status { get; set; }
        
        // å¯¼èˆªå±æ€§
        public virtual User User { get; set; }
        public virtual ICollection<OrderItem> OrderItems { get; set; }
    }
    
    // è®¢å•é¡¹å®ä½“
    public class OrderItem : EntityBase
    {
        public Guid OrderId { get; set; }
        public string ProductId { get; set; }
        public int Quantity { get; set; }
        public decimal UnitPrice { get; set; }
        public decimal TotalPrice { get; set; }
        
        // å¯¼èˆªå±æ€§
        public virtual Order Order { get; set; }
        public virtual Product Product { get; set; }
    }
    
    // äº§å“å®ä½“ï¼ˆä½¿ç”¨å­—ç¬¦ä¸²ä¸»é”®ï¼‰
    public class Product : EntityBaseId<string>
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public decimal Price { get; set; }
        public int StockQuantity { get; set; }
        public string CategoryId { get; set; }
        
        // å¯¼èˆªå±æ€§
        public virtual Category Category { get; set; }
        public virtual ICollection<OrderItem> OrderItems { get; set; }
    }
    
    // åˆ†ç±»å®ä½“ï¼ˆå®ç°æ¥å£ï¼‰
    public class Category : IEntity<string>, IAuditableEntity
    {
        public string Id { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
        public string ParentId { get; set; }
        
        // IAuditableEntityæ¥å£å±æ€§
        public DateTime CreateTime { get; set; }
        public DateTime UpdateTime { get; set; }
        public long CreateUserId { get; set; }
        public long UpdateUserId { get; set; }
        public string CreateUserName { get; set; }
        public string UpdateUserName { get; set; }
        
        // å¯¼èˆªå±æ€§
        public virtual Category Parent { get; set; }
        public virtual ICollection<Category> Children { get; set; }
        public virtual ICollection<Product> Products { get; set; }
    }
    
    public enum OrderStatus
    {
        Pending = 0,
        Confirmed = 1,
        Shipped = 2,
        Delivered = 3,
        Cancelled = 4
    }
}

// ä¸šåŠ¡æœåŠ¡ç¤ºä¾‹
namespace MyApplication.Services
{
    public class UserService
    {
        private readonly ApplicationDbContext _context;
        private readonly ICurrentUserService _currentUserService;
        
        public UserService(ApplicationDbContext context, ICurrentUserService currentUserService)
        {
            _context = context;
            _currentUserService = currentUserService;
        }
        
        public async Task<User> CreateUserAsync(string username, string email, string password)
        {
            var currentUser = await _currentUserService.GetCurrentUserAsync();
            
            var user = new User
            {
                Username = username,
                Email = email,
                PasswordHash = HashPassword(password),
                CreateTime = DateTime.UtcNow,
                UpdateTime = DateTime.UtcNow,
                CreateUserId = currentUser.Id,
                UpdateUserId = currentUser.Id,
                CreateUserName = currentUser.Username,
                UpdateUserName = currentUser.Username,
                IsEnabled = true,
                IsDelete = false,
                Version = 1
            };
            
            _context.Users.Add(user);
            await _context.SaveChangesAsync();
            
            return user;
        }
        
        public async Task<User> UpdateUserAsync(long userId, string email, string firstName, string lastName)
        {
            var user = await _context.Users
                .Where(u => u.Id == userId && !u.IsDelete)
                .FirstOrDefaultAsync();
                
            if (user == null)
                throw new EntityNotFoundException($"ç”¨æˆ· {userId} ä¸å­˜åœ¨");
            
            var currentUser = await _currentUserService.GetCurrentUserAsync();
            var originalVersion = user.Version;
            
            // æ›´æ–°å­—æ®µ
            user.Email = email;
            user.FirstName = firstName;
            user.LastName = lastName;
            user.UpdateTime = DateTime.UtcNow;
            user.UpdateUserId = currentUser.Id;
            user.UpdateUserName = currentUser.Username;
            user.Version++;
            
            try
            {
                await _context.SaveChangesAsync();
                return user;
            }
            catch (DbUpdateConcurrencyException)
            {
                throw new ConcurrencyException("ç”¨æˆ·ä¿¡æ¯å·²è¢«å…¶ä»–ç”¨æˆ·ä¿®æ”¹ï¼Œè¯·åˆ·æ–°åé‡è¯•");
            }
        }
        
        public async Task SoftDeleteUserAsync(long userId)
        {
            var user = await _context.Users
                .Where(u => u.Id == userId && !u.IsDelete)
                .FirstOrDefaultAsync();
                
            if (user == null)
                throw new EntityNotFoundException($"ç”¨æˆ· {userId} ä¸å­˜åœ¨");
            
            var currentUser = await _currentUserService.GetCurrentUserAsync();
            
            user.IsDelete = true;
            user.UpdateTime = DateTime.UtcNow;
            user.UpdateUserId = currentUser.Id;
            user.UpdateUserName = currentUser.Username;
            user.Version++;
            
            await _context.SaveChangesAsync();
        }
        
        public async Task<List<User>> GetActiveUsersAsync()
        {
            return await _context.Users
                .Where(u => u.IsEnabled && !u.IsDelete)
                .OrderBy(u => u.CreateTime)
                .ToListAsync();
        }
        
        private string HashPassword(string password)
        {
            // å®ç°å¯†ç å“ˆå¸Œé€»è¾‘
            return BCrypt.Net.BCrypt.HashPassword(password);
        }
    }
}

### ğŸ·ï¸ ORM å±æ€§æ ‡è®° (GameFrameX.Foundation.Orm.Attribute)

æä¾›ORMæ¡†æ¶çš„å±æ€§æ ‡è®°ï¼Œç”¨äºæ ‡è¯†å®ä½“ç±»çš„ç‰¹æ®ŠåŠŸèƒ½ï¼Œå¦‚å®¡è®¡è·Ÿè¸ªã€ç¼“å­˜ç­–ç•¥ã€è½¯åˆ é™¤å’Œç‰ˆæœ¬æ§åˆ¶ç­‰ã€‚

#### æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ

| ç»„ä»¶           | æ–‡ä»¶å                    | ä¸»è¦åŠŸèƒ½                                    |
|--------------|------------------------|-----------------------------------------|
| **å®¡è®¡è¡¨å±æ€§**    | `AuditTableAttribute.cs` | æ ‡è®°å®ä½“ç±»æ”¯æŒå®¡è®¡è·Ÿè¸ªåŠŸèƒ½ï¼Œè®°å½•æ•°æ®å˜æ›´å†å²                  |
| **ç¼“å­˜è¡¨å±æ€§**    | `CacheTableAttribute.cs` | æ ‡è®°å®ä½“ç±»æ”¯æŒç¼“å­˜ç­–ç•¥ï¼Œæå‡æ•°æ®è®¿é—®æ€§èƒ½                    |
| **è½¯åˆ é™¤å±æ€§**    | `SoftDeleteAttribute.cs` | æ ‡è®°å®ä½“ç±»æ”¯æŒè½¯åˆ é™¤åŠŸèƒ½ï¼Œé€»è¾‘åˆ é™¤è€Œéç‰©ç†åˆ é™¤                 |
| **ç‰ˆæœ¬æ§åˆ¶å±æ€§**   | `VersionControlAttribute.cs` | æ ‡è®°å®ä½“ç±»æ”¯æŒæ•°æ®ç‰ˆæœ¬ç®¡ç†ï¼Œå®ç°ä¹è§‚é”å’Œå¹¶å‘æ§åˆ¶               |

#### å®¡è®¡è¡¨å±æ€§ (AuditTableAttribute)

ç”¨äºæ ‡è®°éœ€è¦è¿›è¡Œå®¡è®¡è·Ÿè¸ªçš„å®ä½“ç±»ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®°å½•æ•°æ®çš„åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ç­‰æ“ä½œå†å²ã€‚

```csharp
using GameFrameX.Foundation.Orm.Attribute;
using GameFrameX.Foundation.Orm.Entity;

// æ ‡è®°ç”¨æˆ·è¡¨éœ€è¦å®¡è®¡è·Ÿè¸ª
[AuditTable]
public class User : EntityBase
{
    public string Username { get; set; }
    public string Email { get; set; }
    public string PasswordHash { get; set; }
    
    // EntityBaseå·²åŒ…å«å®¡è®¡å­—æ®µï¼š
    // CreateTime, UpdateTime, CreateUserId, UpdateUserId, 
    // CreateUserName, UpdateUserName
}

// æ ‡è®°è®¢å•è¡¨éœ€è¦å®¡è®¡è·Ÿè¸ª
[AuditTable]
public class Order : EntityBase
{
    public string OrderNumber { get; set; }
    public long UserId { get; set; }
    public decimal TotalAmount { get; set; }
    public DateTime OrderDate { get; set; }
}

// å®¡è®¡æ‹¦æˆªå™¨ç¤ºä¾‹
public class AuditInterceptor : IDbCommandInterceptor
{
    private readonly ICurrentUserService _currentUserService;
    
    public AuditInterceptor(ICurrentUserService currentUserService)
    {
        _currentUserService = currentUserService;
    }
    
    public override InterceptionResult<int> NonQueryExecuting(
        DbCommand command, 
        CommandEventData eventData, 
        InterceptionResult<int> result)
    {
        var context = eventData.Context;
        var entries = context.ChangeTracker.Entries()
            .Where(e => e.Entity.GetType().GetCustomAttribute<AuditTableAttribute>() != null)
            .ToList();
            
        foreach (var entry in entries)
        {
            if (entry.Entity is IAuditableEntity auditableEntity)
            {
                var currentUser = _currentUserService.GetCurrentUser();
                var now = DateTime.UtcNow;
                
                switch (entry.State)
                {
                    case EntityState.Added:
                        auditableEntity.CreateTime = now;
                        auditableEntity.UpdateTime = now;
                        auditableEntity.CreateUserId = currentUser.Id;
                        auditableEntity.UpdateUserId = currentUser.Id;
                        auditableEntity.CreateUserName = currentUser.Username;
                        auditableEntity.UpdateUserName = currentUser.Username;
                        break;
                        
                    case EntityState.Modified:
                        auditableEntity.UpdateTime = now;
                        auditableEntity.UpdateUserId = currentUser.Id;
                        auditableEntity.UpdateUserName = currentUser.Username;
                        break;
                }
            }
        }
        
        return base.NonQueryExecuting(command, eventData, result);
    }
}
```

#### ç¼“å­˜è¡¨å±æ€§ (CacheTableAttribute)

ç”¨äºæ ‡è®°æ”¯æŒç¼“å­˜ç­–ç•¥çš„å®ä½“ç±»ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¯¹è¿™äº›è¡¨çš„æ•°æ®è¿›è¡Œç¼“å­˜ç®¡ç†ã€‚

```csharp
using GameFrameX.Foundation.Orm.Attribute;
using GameFrameX.Foundation.Orm.Entity;

// æ ‡è®°é…ç½®è¡¨æ”¯æŒç¼“å­˜ï¼ˆé…ç½®æ•°æ®å˜åŒ–é¢‘ç‡ä½ï¼Œé€‚åˆç¼“å­˜ï¼‰
[CacheTable]
public class SystemConfig : EntityBase
{
    public string ConfigKey { get; set; }
    public string ConfigValue { get; set; }
    public string Description { get; set; }
    public string Category { get; set; }
}

// æ ‡è®°å­—å…¸è¡¨æ”¯æŒç¼“å­˜ï¼ˆå­—å…¸æ•°æ®ç›¸å¯¹ç¨³å®šï¼Œé€‚åˆç¼“å­˜ï¼‰
[CacheTable]
public class Dictionary : EntityBase
{
    public string DictType { get; set; }
    public string DictKey { get; set; }
    public string DictValue { get; set; }
    public string Description { get; set; }
    public int SortOrder { get; set; }
}

// æ ‡è®°æƒé™è¡¨æ”¯æŒç¼“å­˜ï¼ˆæƒé™æ•°æ®è®¿é—®é¢‘ç¹ä½†å˜åŒ–ä¸é¢‘ç¹ï¼‰
[CacheTable]
public class Permission : EntityBase
{
    public string PermissionCode { get; set; }
    public string PermissionName { get; set; }
    public string Description { get; set; }
    public string Module { get; set; }
}

// ç¼“å­˜æœåŠ¡ç¤ºä¾‹
public class CacheService<T> where T : class
{
    private readonly IMemoryCache _memoryCache;
    private readonly IDbContext _dbContext;
    private readonly ILogger<CacheService<T>> _logger;
    
    public CacheService(IMemoryCache memoryCache, IDbContext dbContext, ILogger<CacheService<T>> logger)
    {
        _memoryCache = memoryCache;
        _dbContext = dbContext;
        _logger = logger;
    }
    
    public async Task<List<T>> GetAllAsync()
    {
        var entityType = typeof(T);
        var cacheAttribute = entityType.GetCustomAttribute<CacheTableAttribute>();
        
        if (cacheAttribute == null)
        {
            // ä¸æ”¯æŒç¼“å­˜ï¼Œç›´æ¥ä»æ•°æ®åº“æŸ¥è¯¢
            return await _dbContext.Set<T>().ToListAsync();
        }
        
        var cacheKey = $"CacheTable_{entityType.Name}_All";
        
        if (_memoryCache.TryGetValue(cacheKey, out List<T> cachedData))
        {
            _logger.LogDebug($"ä»ç¼“å­˜è·å–æ•°æ®: {cacheKey}");
            return cachedData;
        }
        
        // ä»æ•°æ®åº“æŸ¥è¯¢å¹¶ç¼“å­˜
        var data = await _dbContext.Set<T>().ToListAsync();
        
        var cacheOptions = new MemoryCacheEntryOptions
        {
            AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(30), // 30åˆ†é’Ÿè¿‡æœŸ
            SlidingExpiration = TimeSpan.FromMinutes(5), // 5åˆ†é’Ÿæ»‘åŠ¨è¿‡æœŸ
            Priority = CacheItemPriority.Normal
        };
        
        _memoryCache.Set(cacheKey, data, cacheOptions);
        _logger.LogDebug($"æ•°æ®å·²ç¼“å­˜: {cacheKey}, è®°å½•æ•°: {data.Count}");
        
        return data;
    }
    
    public async Task InvalidateCacheAsync()
    {
        var entityType = typeof(T);
        var cacheKey = $"CacheTable_{entityType.Name}_All";
        
        _memoryCache.Remove(cacheKey);
        _logger.LogDebug($"ç¼“å­˜å·²å¤±æ•ˆ: {cacheKey}");
    }
}

// ç¼“å­˜ç®¡ç†å™¨ç¤ºä¾‹
public class CacheManager
{
    private readonly IServiceProvider _serviceProvider;
    private readonly ILogger<CacheManager> _logger;
    
    public CacheManager(IServiceProvider serviceProvider, ILogger<CacheManager> logger)
    {
        _serviceProvider = serviceProvider;
        _logger = logger;
    }
    
    public async Task RefreshAllCacheTablesAsync()
    {
        var assembly = Assembly.GetExecutingAssembly();
        var cacheTableTypes = assembly.GetTypes()
            .Where(t => t.GetCustomAttribute<CacheTableAttribute>() != null)
            .ToList();
            
        foreach (var type in cacheTableTypes)
        {
            try
            {
                var serviceType = typeof(CacheService<>).MakeGenericType(type);
                var service = _serviceProvider.GetService(serviceType);
                
                if (service != null)
                {
                    var invalidateMethod = serviceType.GetMethod("InvalidateCacheAsync");
                    await (Task)invalidateMethod.Invoke(service, null);
                    
                    var getAllMethod = serviceType.GetMethod("GetAllAsync");
                    await (Task)getAllMethod.Invoke(service, null);
                    
                    _logger.LogInformation($"ç¼“å­˜è¡¨ {type.Name} å·²åˆ·æ–°");
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, $"åˆ·æ–°ç¼“å­˜è¡¨ {type.Name} æ—¶å‘ç”Ÿé”™è¯¯");
            }
        }
    }
}
```

#### è½¯åˆ é™¤å±æ€§ (SoftDeleteAttribute)

ç”¨äºæ ‡è®°æ”¯æŒè½¯åˆ é™¤åŠŸèƒ½çš„å®ä½“ç±»ï¼Œåˆ é™¤æ“ä½œä¼šå°†è®°å½•æ ‡è®°ä¸ºå·²åˆ é™¤è€Œä¸æ˜¯ç‰©ç†åˆ é™¤ã€‚

```csharp
using GameFrameX.Foundation.Orm.Attribute;
using GameFrameX.Foundation.Orm.Entity;

// æ ‡è®°ç”¨æˆ·è¡¨æ”¯æŒè½¯åˆ é™¤
[SoftDelete]
public class User : EntityBase
{
    public string Username { get; set; }
    public string Email { get; set; }
    public string PasswordHash { get; set; }
    
    // EntityBaseå·²åŒ…å«IsDeleteå­—æ®µ
}

// æ ‡è®°æ–‡ç« è¡¨æ”¯æŒè½¯åˆ é™¤
[SoftDelete]
public class Article : EntityBase
{
    public string Title { get; set; }
    public string Content { get; set; }
    public long AuthorId { get; set; }
    public DateTime PublishTime { get; set; }
}

// è½¯åˆ é™¤æ‹¦æˆªå™¨
public class SoftDeleteInterceptor : IDbCommandInterceptor
{
    public override InterceptionResult<int> NonQueryExecuting(
        DbCommand command, 
        CommandEventData eventData, 
        InterceptionResult<int> result)
    {
        var context = eventData.Context;
        
        // å¤„ç†è½¯åˆ é™¤å®ä½“çš„åˆ é™¤æ“ä½œ
        var softDeleteEntries = context.ChangeTracker.Entries()
            .Where(e => e.State == EntityState.Deleted && 
                       e.Entity.GetType().GetCustomAttribute<SoftDeleteAttribute>() != null)
            .ToList();
            
        foreach (var entry in softDeleteEntries)
        {
            // å°†åˆ é™¤æ“ä½œè½¬æ¢ä¸ºæ›´æ–°æ“ä½œ
            entry.State = EntityState.Modified;
            
            if (entry.Entity is EntityBase entityBase)
            {
                entityBase.IsDelete = true;
                entityBase.UpdateTime = DateTime.UtcNow;
                // è®¾ç½®æ›´æ–°ç”¨æˆ·ä¿¡æ¯...
            }
        }
        
        return base.NonQueryExecuting(command, eventData, result);
    }
}

// è½¯åˆ é™¤æŸ¥è¯¢è¿‡æ»¤å™¨
public static class SoftDeleteQueryExtensions
{
    public static IQueryable<T> WhereNotDeleted<T>(this IQueryable<T> query) 
        where T : class
    {
        var entityType = typeof(T);
        var softDeleteAttribute = entityType.GetCustomAttribute<SoftDeleteAttribute>();
        
        if (softDeleteAttribute != null && typeof(EntityBase).IsAssignableFrom(entityType))
        {
            return query.Where(e => !((EntityBase)(object)e).IsDelete);
        }
        
        return query;
    }
    
    public static IQueryable<T> IncludeDeleted<T>(this IQueryable<T> query) 
        where T : class
    {
        // è¿”å›åŒ…å«å·²åˆ é™¤è®°å½•çš„æŸ¥è¯¢
        return query;
    }
    
    public static IQueryable<T> OnlyDeleted<T>(this IQueryable<T> query) 
        where T : class
    {
        var entityType = typeof(T);
        var softDeleteAttribute = entityType.GetCustomAttribute<SoftDeleteAttribute>();
        
        if (softDeleteAttribute != null && typeof(EntityBase).IsAssignableFrom(entityType))
        {
            return query.Where(e => ((EntityBase)(object)e).IsDelete);
        }
        
        return query.Where(_ => false); // å¦‚æœä¸æ”¯æŒè½¯åˆ é™¤ï¼Œè¿”å›ç©ºç»“æœ
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class UserService
{
    private readonly ApplicationDbContext _context;
    
    public UserService(ApplicationDbContext context)
    {
        _context = context;
    }
    
    // è·å–æ´»è·ƒç”¨æˆ·ï¼ˆè‡ªåŠ¨è¿‡æ»¤å·²åˆ é™¤ï¼‰
    public async Task<List<User>> GetActiveUsersAsync()
    {
        return await _context.Users
            .WhereNotDeleted()
            .ToListAsync();
    }
    
    // è·å–å·²åˆ é™¤ç”¨æˆ·
    public async Task<List<User>> GetDeletedUsersAsync()
    {
        return await _context.Users
            .OnlyDeleted()
            .ToListAsync();
    }
    
    // è·å–æ‰€æœ‰ç”¨æˆ·ï¼ˆåŒ…å«å·²åˆ é™¤ï¼‰
    public async Task<List<User>> GetAllUsersAsync()
    {
        return await _context.Users
            .IncludeDeleted()
            .ToListAsync();
    }
    
    // è½¯åˆ é™¤ç”¨æˆ·
    public async Task SoftDeleteUserAsync(long userId)
    {
        var user = await _context.Users.FindAsync(userId);
        if (user != null)
        {
            _context.Users.Remove(user); // ä¼šè¢«æ‹¦æˆªå™¨è½¬æ¢ä¸ºè½¯åˆ é™¤
            await _context.SaveChangesAsync();
        }
    }
    
    // æ¢å¤å·²åˆ é™¤ç”¨æˆ·
    public async Task RestoreUserAsync(long userId)
    {
        var user = await _context.Users
            .IncludeDeleted()
            .FirstOrDefaultAsync(u => u.Id == userId);
            
        if (user != null && user.IsDelete)
        {
            user.IsDelete = false;
            user.UpdateTime = DateTime.UtcNow;
            await _context.SaveChangesAsync();
        }
    }
}
```

#### ç‰ˆæœ¬æ§åˆ¶å±æ€§ (VersionControlAttribute)

ç”¨äºæ ‡è®°æ”¯æŒæ•°æ®ç‰ˆæœ¬ç®¡ç†çš„å®ä½“ç±»ï¼Œå®ç°ä¹è§‚é”å’Œå¹¶å‘æ§åˆ¶åŠŸèƒ½ã€‚

```csharp
using GameFrameX.Foundation.Orm.Attribute;
using GameFrameX.Foundation.Orm.Entity;

// æ ‡è®°ç”¨æˆ·è¡¨æ”¯æŒç‰ˆæœ¬æ§åˆ¶
[VersionControl]
public class User : EntityBase
{
    public string Username { get; set; }
    public string Email { get; set; }
    public string PasswordHash { get; set; }
    
    // EntityBaseå·²åŒ…å«Versionå­—æ®µ
}

// æ ‡è®°åº“å­˜è¡¨æ”¯æŒç‰ˆæœ¬æ§åˆ¶ï¼ˆé˜²æ­¢è¶…å–ï¼‰
[VersionControl]
public class Inventory : EntityBase
{
    public string ProductId { get; set; }
    public int Quantity { get; set; }
    public int ReservedQuantity { get; set; }
    public decimal UnitCost { get; set; }
}

// æ ‡è®°è´¦æˆ·ä½™é¢è¡¨æ”¯æŒç‰ˆæœ¬æ§åˆ¶ï¼ˆé˜²æ­¢å¹¶å‘æ“ä½œå¯¼è‡´ä½™é¢é”™è¯¯ï¼‰
[VersionControl]
public class AccountBalance : EntityBase
{
    public long UserId { get; set; }
    public decimal Balance { get; set; }
    public decimal FrozenAmount { get; set; }
    public string Currency { get; set; }
}

// ç‰ˆæœ¬æ§åˆ¶æ‹¦æˆªå™¨
public class VersionControlInterceptor : IDbCommandInterceptor
{
    public override InterceptionResult<int> NonQueryExecuting(
        DbCommand command, 
        CommandEventData eventData, 
        InterceptionResult<int> result)
    {
        var context = eventData.Context;
        
        // å¤„ç†ç‰ˆæœ¬æ§åˆ¶å®ä½“çš„æ›´æ–°æ“ä½œ
        var versionControlEntries = context.ChangeTracker.Entries()
            .Where(e => e.State == EntityState.Modified && 
                       e.Entity.GetType().GetCustomAttribute<VersionControlAttribute>() != null)
            .ToList();
            
        foreach (var entry in versionControlEntries)
        {
            if (entry.Entity is EntityBase entityBase)
            {
                // è‡ªåŠ¨é€’å¢ç‰ˆæœ¬å·
                entityBase.Version++;
                
                // æ ‡è®°Versionå­—æ®µä¸ºå·²ä¿®æ”¹
                entry.Property(nameof(EntityBase.Version)).IsModified = true;
            }
        }
        
        return base.NonQueryExecuting(command, eventData, result);
    }
}

// ç‰ˆæœ¬æ§åˆ¶æœåŠ¡
public class VersionControlService<T> where T : EntityBase
{
    private readonly IDbContext _dbContext;
    private readonly ILogger<VersionControlService<T>> _logger;
    
    public VersionControlService(IDbContext dbContext, ILogger<VersionControlService<T>> logger)
    {
        _dbContext = dbContext;
        _logger = logger;
    }
    
    public async Task<T> UpdateWithVersionCheckAsync(long id, Action<T> updateAction, int maxRetries = 3)
    {
        var entityType = typeof(T);
        var versionControlAttribute = entityType.GetCustomAttribute<VersionControlAttribute>();
        
        if (versionControlAttribute == null)
        {
            throw new InvalidOperationException($"å®ä½“ç±»å‹ {entityType.Name} æœªæ ‡è®° VersionControlAttribute");
        }
        
        for (int attempt = 1; attempt <= maxRetries; attempt++)
        {
            try
            {
                var entity = await _dbContext.Set<T>().FindAsync(id);
                if (entity == null)
                {
                    throw new EntityNotFoundException($"å®ä½“ {entityType.Name} (ID: {id}) ä¸å­˜åœ¨");
                }
                
                var originalVersion = entity.Version;
                
                // æ‰§è¡Œæ›´æ–°æ“ä½œ
                updateAction(entity);
                
                // è®¾ç½®æ›´æ–°æ—¶é—´
                entity.UpdateTime = DateTime.UtcNow;
                
                // ä¿å­˜æ›´æ”¹
                await _dbContext.SaveChangesAsync();
                
                _logger.LogDebug($"å®ä½“ {entityType.Name} (ID: {id}) æ›´æ–°æˆåŠŸï¼Œç‰ˆæœ¬ä» {originalVersion} æ›´æ–°åˆ° {entity.Version}");
                return entity;
            }
            catch (DbUpdateConcurrencyException ex)
            {
                _logger.LogWarning($"å®ä½“ {entityType.Name} (ID: {id}) ç‰ˆæœ¬å†²çªï¼Œç¬¬ {attempt} æ¬¡é‡è¯•");
                
                if (attempt == maxRetries)
                {
                    throw new ConcurrencyException($"å®ä½“ {entityType.Name} (ID: {id}) åœ¨ {maxRetries} æ¬¡é‡è¯•åä»ç„¶å­˜åœ¨ç‰ˆæœ¬å†²çª", ex);
                }
                
                // é‡æ–°åŠ è½½å®ä½“ä»¥è·å–æœ€æ–°ç‰ˆæœ¬
                _dbContext.Entry(await _dbContext.Set<T>().FindAsync(id)).Reload();
                
                // ç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•
                await Task.Delay(TimeSpan.FromMilliseconds(100 * attempt));
            }
        }
        
        throw new InvalidOperationException("ä¸åº”è¯¥åˆ°è¾¾è¿™é‡Œ");
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class InventoryService
{
    private readonly VersionControlService<Inventory> _versionControlService;
    private readonly ApplicationDbContext _context;
    
    public InventoryService(VersionControlService<Inventory> versionControlService, ApplicationDbContext context)
    {
        _versionControlService = versionControlService;
        _context = context;
    }
    
    // å‡å°‘åº“å­˜ï¼ˆé˜²æ­¢è¶…å–ï¼‰
    public async Task<bool> ReduceInventoryAsync(string productId, int quantity)
    {
        var inventory = await _context.Inventories
            .FirstOrDefaultAsync(i => i.ProductId == productId);
            
        if (inventory == null)
        {
            throw new EntityNotFoundException($"äº§å“ {productId} çš„åº“å­˜è®°å½•ä¸å­˜åœ¨");
        }
        
        try
        {
            await _versionControlService.UpdateWithVersionCheckAsync(inventory.Id, inv =>
            {
                if (inv.Quantity < quantity)
                {
                    throw new InsufficientInventoryException($"åº“å­˜ä¸è¶³ï¼Œå½“å‰åº“å­˜: {inv.Quantity}ï¼Œéœ€è¦: {quantity}");
                }
                
                inv.Quantity -= quantity;
            });
            
            return true;
        }
        catch (ConcurrencyException)
        {
            // ç‰ˆæœ¬å†²çªï¼Œå¯èƒ½æ˜¯å¹¶å‘æ“ä½œå¯¼è‡´
            throw new ConcurrencyException("åº“å­˜æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•");
        }
    }
    
    // å¢åŠ åº“å­˜
    public async Task AddInventoryAsync(string productId, int quantity)
    {
        var inventory = await _context.Inventories
            .FirstOrDefaultAsync(i => i.ProductId == productId);
            
        if (inventory == null)
        {
            throw new EntityNotFoundException($"äº§å“ {productId} çš„åº“å­˜è®°å½•ä¸å­˜åœ¨");
        }
        
        await _versionControlService.UpdateWithVersionCheckAsync(inventory.Id, inv =>
        {
            inv.Quantity += quantity;
        });
    }
}

// è´¦æˆ·ä½™é¢æœåŠ¡ç¤ºä¾‹
public class AccountBalanceService
{
    private readonly VersionControlService<AccountBalance> _versionControlService;
    private readonly ApplicationDbContext _context;
    
    public AccountBalanceService(VersionControlService<AccountBalance> versionControlService, ApplicationDbContext context)
    {
        _versionControlService = versionControlService;
        _context = context;
    }
    
    // æ‰£å‡ä½™é¢
    public async Task<bool> DeductBalanceAsync(long userId, decimal amount, string currency = "CNY")
    {
        var balance = await _context.AccountBalances
            .FirstOrDefaultAsync(b => b.UserId == userId && b.Currency == currency);
            
        if (balance == null)
        {
            throw new EntityNotFoundException($"ç”¨æˆ· {userId} çš„ {currency} è´¦æˆ·ä¸å­˜åœ¨");
        }
        
        try
        {
            await _versionControlService.UpdateWithVersionCheckAsync(balance.Id, bal =>
            {
                if (bal.Balance < amount)
                {
                    throw new InsufficientBalanceException($"ä½™é¢ä¸è¶³ï¼Œå½“å‰ä½™é¢: {bal.Balance}ï¼Œéœ€è¦: {amount}");
                }
                
                bal.Balance -= amount;
            });
            
            return true;
        }
        catch (ConcurrencyException)
        {
            throw new ConcurrencyException("ä½™é¢æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•");
        }
    }
    
    // å¢åŠ ä½™é¢
    public async Task AddBalanceAsync(long userId, decimal amount, string currency = "CNY")
    {
        var balance = await _context.AccountBalances
            .FirstOrDefaultAsync(b => b.UserId == userId && b.Currency == currency);
            
        if (balance == null)
        {
            throw new EntityNotFoundException($"ç”¨æˆ· {userId} çš„ {currency} è´¦æˆ·ä¸å­˜åœ¨");
        }
        
        await _versionControlService.UpdateWithVersionCheckAsync(balance.Id, bal =>
        {
            bal.Balance += amount;
        });
    }
}
```

#### å®Œæ•´é›†æˆç¤ºä¾‹

```csharp
using GameFrameX.Foundation.Orm.Attribute;
using GameFrameX.Foundation.Orm.Entity;
using Microsoft.EntityFrameworkCore;

namespace MyApplication.Entities
{
    // ç”¨æˆ·å®ä½“ï¼šæ”¯æŒå®¡è®¡ã€è½¯åˆ é™¤ã€ç‰ˆæœ¬æ§åˆ¶
    [AuditTable]
    [SoftDelete]
    [VersionControl]
    public class User : EntityBase
    {
        public string Username { get; set; }
        public string Email { get; set; }
        public string PasswordHash { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public DateTime? LastLoginTime { get; set; }
    }
    
    // ç³»ç»Ÿé…ç½®ï¼šæ”¯æŒç¼“å­˜ã€å®¡è®¡
    [CacheTable]
    [AuditTable]
    public class SystemConfig : EntityBase
    {
        public string ConfigKey { get; set; }
        public string ConfigValue { get; set; }
        public string Description { get; set; }
        public string Category { get; set; }
    }
    
    // åº“å­˜è®°å½•ï¼šæ”¯æŒç‰ˆæœ¬æ§åˆ¶ã€å®¡è®¡
    [VersionControl]
    [AuditTable]
    public class Inventory : EntityBase
    {
        public string ProductId { get; set; }
        public int Quantity { get; set; }
        public int ReservedQuantity { get; set; }
        public decimal UnitCost { get; set; }
        public string WarehouseCode { get; set; }
    }
    
    // è®¢å•è®°å½•ï¼šæ”¯æŒå®¡è®¡ã€è½¯åˆ é™¤
    [AuditTable]
    [SoftDelete]
    public class Order : EntityBase
    {
        public string OrderNumber { get; set; }
        public long UserId { get; set; }
        public decimal TotalAmount { get; set; }
        public DateTime OrderDate { get; set; }
        public OrderStatus Status { get; set; }
        
        public virtual User User { get; set; }
        public virtual ICollection<OrderItem> OrderItems { get; set; }
    }
}

// DbContexté…ç½®
public class ApplicationDbContext : DbContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<SystemConfig> SystemConfigs { get; set; }
    public DbSet<Inventory> Inventories { get; set; }
    public DbSet<Order> Orders { get; set; }
    
    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        optionsBuilder
            .AddInterceptors(
                new AuditInterceptor(),
                new SoftDeleteInterceptor(),
                new VersionControlInterceptor()
            );
    }
    
    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        // ä¸ºæ‰€æœ‰æ ‡è®°äº†SoftDeleteAttributeçš„å®ä½“æ·»åŠ å…¨å±€æŸ¥è¯¢è¿‡æ»¤å™¨
        foreach (var entityType in modelBuilder.Model.GetEntityTypes())
        {
            var clrType = entityType.ClrType;
            if (clrType.GetCustomAttribute<SoftDeleteAttribute>() != null &&
                typeof(EntityBase).IsAssignableFrom(clrType))
            {
                var parameter = Expression.Parameter(clrType, "e");
                var property = Expression.Property(parameter, nameof(EntityBase.IsDelete));
                var condition = Expression.Equal(property, Expression.Constant(false));
                var lambda = Expression.Lambda(condition, parameter);
                
                modelBuilder.Entity(clrType).HasQueryFilter(lambda);
            }
        }
        
        base.OnModelCreating(modelBuilder);
    }
}

// æœåŠ¡æ³¨å†Œ
public void ConfigureServices(IServiceCollection services)
{
    services.AddDbContext<ApplicationDbContext>(options =>
        options.UseSqlServer(connectionString));
    
    services.AddScoped<AuditInterceptor>();
    services.AddScoped<SoftDeleteInterceptor>();
    services.AddScoped<VersionControlInterceptor>();
    
    services.AddScoped(typeof(CacheService<>));
    services.AddScoped(typeof(VersionControlService<>));
    services.AddScoped<CacheManager>();
    
    services.AddMemoryCache();
}
```

### ï¿½ æ—¥å¿—å·¥å…·åº“ (GameFrameX.Foundation.Logger)

åŸºäº Serilog çš„æ—¥å¿—é…ç½®å·¥å…·ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„æ—¥å¿—è®°å½•åŠŸèƒ½ã€‚

#### ç‰¹æ€§

- æ”¯æŒå¤šç§æ—¥å¿—çº§åˆ« (Debug, Info, Warning, Error, Fatal)
- çµæ´»çš„è¾“å‡ºé…ç½®
- æ”¯æŒè‡ªå®šä¹‰æ—¥å¿—æä¾›ç¨‹åº
- æä¾›æ—¥å¿—è‡ªæˆ‘è¯Šæ–­

#### ä½¿ç”¨ç¤ºä¾‹

```csharp
// åˆå§‹åŒ–æ—¥å¿—
LogHandler.Create(LogOptions.Default);

// è®°å½•æ—¥å¿—
LogHelper.Debug("è°ƒè¯•ä¿¡æ¯");
LogHelper.Info("æ™®é€šä¿¡æ¯");
LogHelper.Warning("è­¦å‘Šä¿¡æ¯");
LogHelper.Error("é”™è¯¯ä¿¡æ¯");
LogHelper.Fatal("è‡´å‘½é”™è¯¯");
```

### âš™ï¸ å‘½ä»¤è¡Œå‚æ•°å¤„ç† (GameFrameX.Foundation.Options)

ä¸€ä¸ªå¼ºå¤§çš„å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡è§£æåº“ï¼Œæ”¯æŒå°†å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡è‡ªåŠ¨æ˜ å°„åˆ°å¼ºç±»å‹é…ç½®å¯¹è±¡ã€‚

#### ç‰¹æ€§

- âœ… **å‚æ•°ä¼˜å…ˆçº§å¤„ç†**: å‘½ä»¤è¡Œå‚æ•° > ç¯å¢ƒå˜é‡ > é»˜è®¤å€¼
- âœ… **æ³›å‹æ”¯æŒ**: æ”¯æŒä»»æ„å¼ºç±»å‹é…ç½®ç±»
- âœ… **å¤šç§å¯åŠ¨æ–¹å¼å…¼å®¹**: æ”¯æŒDockerã€exeã€shellç­‰å¯åŠ¨æ–¹å¼
- âœ… **è‡ªåŠ¨å‰ç¼€å¤„ç†**: è‡ªåŠ¨ä¸ºå‚æ•°æ·»åŠ `--`å‰ç¼€
- âœ… **å¸ƒå°”å‚æ•°æ”¯æŒ**: æ”¯æŒå¤šç§å¸ƒå°”å‚æ•°æ ¼å¼
- âœ… **ç¯å¢ƒå˜é‡æ˜ å°„**: è‡ªåŠ¨æ˜ å°„ç¯å¢ƒå˜é‡åˆ°é…ç½®å±æ€§
- âœ… **ç±»å‹è½¬æ¢**: è‡ªåŠ¨è½¬æ¢å­—ç¬¦ä¸²å‚æ•°åˆ°ç›®æ ‡ç±»å‹
- âœ… **ç‰¹æ€§æ”¯æŒ**: æ”¯æŒä¸°å¯Œçš„é…ç½®ç‰¹æ€§

#### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶                             | åŠŸèƒ½æè¿°                 |
|--------------------------------|----------------------|
| `CommandLineArgumentConverter` | å‘½ä»¤è¡Œå‚æ•°è½¬æ¢å™¨ï¼Œæä¾›å‚æ•°å¤„ç†çš„æ ¸å¿ƒåŠŸèƒ½ |
| `OptionsBuilder<T>`            | é…ç½®æ„å»ºå™¨ï¼Œç”¨äºæ„å»ºæ³›å‹é…ç½®å¯¹è±¡     |
| `OptionsProvider`              | é…ç½®æä¾›å™¨ï¼Œç”¨äºè·å–å’Œç®¡ç†é…ç½®å¯¹è±¡    |

#### å¿«é€Ÿå¼€å§‹

##### 1. å®šä¹‰é…ç½®ç±»

```csharp
public class AppConfig
{
    public string Host { get; set; } = "localhost";
    public int Port { get; set; } = 8080;
    public bool Debug { get; set; } = false;
    public string LogLevel { get; set; } = "info";
    public double Timeout { get; set; } = 30.5;
}
```

##### 2. ä½¿ç”¨OptionsBuilder

```csharp
using GameFrameX.Foundation.Options;

class Program
{
    static void Main(string[] args)
    {
        // åˆ›å»ºé€‰é¡¹æ„å»ºå™¨
        var builder = new OptionsBuilder<AppConfig>(args);
        
        // æ„å»ºé…ç½®å¯¹è±¡
        var config = builder.Build();
        
        // ä½¿ç”¨é…ç½®
        Console.WriteLine($"æœåŠ¡å™¨: {config.Host}:{config.Port}");
        Console.WriteLine($"è°ƒè¯•æ¨¡å¼: {config.Debug}");
        Console.WriteLine($"æ—¥å¿—çº§åˆ«: {config.LogLevel}");
        Console.WriteLine($"è¶…æ—¶æ—¶é—´: {config.Timeout}ç§’");
    }
}
```

#### ä½¿ç”¨æ–¹å¼

##### å‘½ä»¤è¡Œå‚æ•°

æ”¯æŒå¤šç§å‚æ•°æ ¼å¼ï¼š

```bash
# é”®å€¼å¯¹æ ¼å¼
myapp.exe --host=example.com --port=9090 --debug=true

# åˆ†ç¦»æ ¼å¼
myapp.exe --host example.com --port 9090 --debug true

# å¸ƒå°”æ ‡å¿—æ ¼å¼
myapp.exe --host example.com --port 9090 --debug

# æ··åˆæ ¼å¼
myapp.exe --host=example.com --port 9090 --debug
```

##### ç¯å¢ƒå˜é‡

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export HOST=example.com
export PORT=9090
export DEBUG=true

# è¿è¡Œç¨‹åº
myapp.exe
```

##### Dockeræ”¯æŒ

```dockerfile
# Dockerfile
FROM mcr.microsoft.com/dotnet/runtime:8.0
COPY . /app
WORKDIR /app
ENTRYPOINT ["dotnet", "MyApp.dll"]
```

```bash
# Dockerè¿è¡Œ
docker run myapp --host example.com --port 9090 --debug

# æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡
docker run -e HOST=example.com -e PORT=9090 -e DEBUG=true myapp
```

#### é«˜çº§ç‰¹æ€§

##### ä½¿ç”¨ç‰¹æ€§é…ç½®

```csharp
using GameFrameX.Foundation.Options.Attributes;

public class AdvancedConfig
{
    [Option("h", "host", Required = false, DefaultValue = "localhost")]
    [HelpText("æœåŠ¡å™¨ä¸»æœºåœ°å€")]
    public string Host { get; set; }

    [Option("p", "port", Required = true)]
    [HelpText("æœåŠ¡å™¨ç«¯å£å·")]
    public int Port { get; set; }

    [FlagOption("d", "debug")]
    [HelpText("å¯ç”¨è°ƒè¯•æ¨¡å¼")]
    public bool Debug { get; set; }

    [RequiredOption("api-key", Required = true)]
    [EnvironmentVariable("API_KEY")]
    [HelpText("APIå¯†é’¥")]
    public string ApiKey { get; set; }

    [DefaultValue(30.0)]
    public double Timeout { get; set; }
}
```

##### æ„å»ºå™¨é€‰é¡¹

```csharp
var builder = new OptionsBuilder<AppConfig>(
    args: args,
    boolFormat: BoolArgumentFormat.Flag,        // å¸ƒå°”å‚æ•°æ ¼å¼
    ensurePrefixedKeys: true,                   // ç¡®ä¿å‚æ•°æœ‰å‰ç¼€
    useEnvironmentVariables: true              // ä½¿ç”¨ç¯å¢ƒå˜é‡
);

var config = builder.Build(skipValidation: false); // æ˜¯å¦è·³è¿‡éªŒè¯
```

#### å‚æ•°ä¼˜å…ˆçº§

å‚æ•°æŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§åº”ç”¨ï¼ˆé«˜ä¼˜å…ˆçº§è¦†ç›–ä½ä¼˜å…ˆçº§ï¼‰ï¼š

1. **å‘½ä»¤è¡Œå‚æ•°** (æœ€é«˜ä¼˜å…ˆçº§)
2. **ç¯å¢ƒå˜é‡**
3. **é»˜è®¤å€¼** (æœ€ä½ä¼˜å…ˆçº§)

##### ç¤ºä¾‹

```csharp
public class Config
{
    public string Host { get; set; } = "localhost";  // é»˜è®¤å€¼
    public int Port { get; set; } = 8080;           // é»˜è®¤å€¼
}
```

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export HOST=env.example.com
export PORT=7070

# è¿è¡Œç¨‹åºï¼ˆå‘½ä»¤è¡Œå‚æ•°è¦†ç›–ç¯å¢ƒå˜é‡ï¼‰
myapp.exe --host cmd.example.com

# ç»“æœï¼š
# Host = "cmd.example.com"  (æ¥è‡ªå‘½ä»¤è¡Œå‚æ•°)
# Port = 7070               (æ¥è‡ªç¯å¢ƒå˜é‡)
```

#### å¸ƒå°”å‚æ•°å¤„ç†

æ”¯æŒå¤šç§å¸ƒå°”å‚æ•°æ ¼å¼ï¼š

```bash
# æ ‡å¿—æ ¼å¼ï¼ˆæ¨èï¼‰
myapp.exe --debug                    # debug = true

# é”®å€¼å¯¹æ ¼å¼
myapp.exe --debug=true               # debug = true
myapp.exe --debug=false              # debug = false

# åˆ†ç¦»æ ¼å¼
myapp.exe --debug true               # debug = true
myapp.exe --debug false              # debug = false

# æ”¯æŒçš„å¸ƒå°”å€¼
true, false, 1, 0, yes, no, on, off
```

#### ç±»å‹è½¬æ¢

è‡ªåŠ¨æ”¯æŒä»¥ä¸‹ç±»å‹è½¬æ¢ï¼š

- `string` - ç›´æ¥ä½¿ç”¨
- `int`, `int?` - æ•´æ•°è½¬æ¢
- `bool`, `bool?` - å¸ƒå°”å€¼è½¬æ¢
- `double`, `double?` - åŒç²¾åº¦æµ®ç‚¹æ•°è½¬æ¢
- `float`, `float?` - å•ç²¾åº¦æµ®ç‚¹æ•°è½¬æ¢
- `decimal`, `decimal?` - åè¿›åˆ¶æ•°è½¬æ¢
- `DateTime`, `DateTime?` - æ—¥æœŸæ—¶é—´è½¬æ¢
- `Guid`, `Guid?` - GUIDè½¬æ¢
- `Enum` - æšä¸¾è½¬æ¢

##### ç¤ºä¾‹

```csharp
public class TypedConfig
{
    public int Port { get; set; }
    public bool Debug { get; set; }
    public DateTime StartTime { get; set; }
    public LogLevel Level { get; set; }  // æšä¸¾
}

public enum LogLevel
{
    Debug, Info, Warning, Error
}
```

```bash
myapp.exe --port 9090 --debug true --start-time "2024-01-01 10:00:00" --level Info
```

#### é”™è¯¯å¤„ç†

##### å¿…éœ€å‚æ•°éªŒè¯

```csharp
public class Config
{
    [RequiredOption("api-key", Required = true)]
    public string ApiKey { get; set; }
}
```

å¦‚æœç¼ºå°‘å¿…éœ€å‚æ•°ï¼Œä¼šæŠ›å‡º `ArgumentException`ï¼š

```
ç¼ºå°‘å¿…éœ€çš„é€‰é¡¹: api-key
```

##### ç±»å‹è½¬æ¢é”™è¯¯

å½“å‚æ•°å€¼æ— æ³•è½¬æ¢ä¸ºç›®æ ‡ç±»å‹æ—¶ï¼Œä¼šä½¿ç”¨é»˜è®¤å€¼å¹¶åœ¨æ§åˆ¶å°è¾“å‡ºè­¦å‘Šä¿¡æ¯ã€‚

#### æœ€ä½³å®è·µ

##### 1. é…ç½®ç±»è®¾è®¡

```csharp
public class AppConfig
{
    // ä½¿ç”¨æœ‰æ„ä¹‰çš„é»˜è®¤å€¼
    public string Host { get; set; } = "localhost";
    public int Port { get; set; } = 8080;
    
    // å¸ƒå°”å±æ€§é»˜è®¤ä¸ºfalse
    public bool Debug { get; set; } = false;
    
    // ä½¿ç”¨ç‰¹æ€§æä¾›æ›´å¤šä¿¡æ¯
    [RequiredOption("database-url", Required = true)]
    [EnvironmentVariable("DATABASE_URL")]
    public string DatabaseUrl { get; set; }
}
```

##### 2. é”™è¯¯å¤„ç†

```csharp
try
{
    var builder = new OptionsBuilder<AppConfig>(args);
    var config = builder.Build();
    
    // ä½¿ç”¨é…ç½®å¯åŠ¨åº”ç”¨
    StartApplication(config);
}
catch (ArgumentException ex)
{
    Console.WriteLine($"é…ç½®é”™è¯¯: {ex.Message}");
    Environment.Exit(1);
}
```

##### 3. Dockeré›†æˆ

```csharp
// Program.cs
public class Program
{
    public static void Main(string[] args)
    {
        var builder = new OptionsBuilder<AppConfig>(args);
        var config = builder.Build();
        
        // åœ¨Dockerä¸­ï¼Œé€šå¸¸ä½¿ç”¨ç¯å¢ƒå˜é‡
        // åœ¨å¼€å‘ä¸­ï¼Œé€šå¸¸ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°
        
        var app = CreateApplication(config);
        app.Run();
    }
}
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  myapp:
    image: myapp:latest
    environment:
      - HOST=0.0.0.0
      - PORT=8080
      - DEBUG=false
    command: [ "--log-level", "info" ]
```

#### å®Œæ•´ç¤ºä¾‹

```csharp
using GameFrameX.Foundation.Options;
using GameFrameX.Foundation.Options.Attributes;

namespace MyApp
{
    public class ServerConfig
    {
        [Option("h", "host", DefaultValue = "localhost")]
        [EnvironmentVariable("SERVER_HOST")]
        [HelpText("æœåŠ¡å™¨ä¸»æœºåœ°å€")]
        public string Host { get; set; }

        [Option("p", "port", DefaultValue = 8080)]
        [EnvironmentVariable("SERVER_PORT")]
        [HelpText("æœåŠ¡å™¨ç«¯å£å·")]
        public int Port { get; set; }

        [FlagOption("d", "debug")]
        [EnvironmentVariable("DEBUG")]
        [HelpText("å¯ç”¨è°ƒè¯•æ¨¡å¼")]
        public bool Debug { get; set; }

        [RequiredOption("database-url", Required = true)]
        [EnvironmentVariable("DATABASE_URL")]
        [HelpText("æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²")]
        public string DatabaseUrl { get; set; }

        [Option("timeout", DefaultValue = 30.0)]
        [EnvironmentVariable("REQUEST_TIMEOUT")]
        [HelpText("è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰")]
        public double Timeout { get; set; }
    }

    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                var builder = new OptionsBuilder<ServerConfig>(args);
                var config = builder.Build();

                Console.WriteLine("æœåŠ¡å™¨é…ç½®:");
                Console.WriteLine($"  ä¸»æœº: {config.Host}");
                Console.WriteLine($"  ç«¯å£: {config.Port}");
                Console.WriteLine($"  è°ƒè¯•: {config.Debug}");
                Console.WriteLine($"  æ•°æ®åº“: {config.DatabaseUrl}");
                Console.WriteLine($"  è¶…æ—¶: {config.Timeout}ç§’");

                // å¯åŠ¨æœåŠ¡å™¨
                StartServer(config);
            }
            catch (ArgumentException ex)
            {
                Console.WriteLine($"é…ç½®é”™è¯¯: {ex.Message}");
                ShowHelp();
                Environment.Exit(1);
            }
        }

        static void StartServer(ServerConfig config)
        {
            // æœåŠ¡å™¨å¯åŠ¨é€»è¾‘
            Console.WriteLine($"æœåŠ¡å™¨å¯åŠ¨åœ¨ {config.Host}:{config.Port}");
        }

        static void ShowHelp()
        {
            Console.WriteLine("ç”¨æ³•:");
            Console.WriteLine("  myapp.exe --host <ä¸»æœº> --port <ç«¯å£> --database-url <æ•°æ®åº“URL> [é€‰é¡¹]");
            Console.WriteLine();
            Console.WriteLine("é€‰é¡¹:");
            Console.WriteLine("  -h, --host <ä¸»æœº>           æœåŠ¡å™¨ä¸»æœºåœ°å€ (é»˜è®¤: localhost)");
            Console.WriteLine("  -p, --port <ç«¯å£>           æœåŠ¡å™¨ç«¯å£å· (é»˜è®¤: 8080)");
            Console.WriteLine("  -d, --debug                 å¯ç”¨è°ƒè¯•æ¨¡å¼");
            Console.WriteLine("      --database-url <URL>    æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² (å¿…éœ€)");
            Console.WriteLine("      --timeout <ç§’>          è¯·æ±‚è¶…æ—¶æ—¶é—´ (é»˜è®¤: 30.0)");
        }
    }
}
```

#### CommandLineArgumentConverter ä½¿ç”¨

é™¤äº† OptionsBuilder ä¹‹å¤–ï¼Œæ‚¨ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨åº•å±‚çš„ CommandLineArgumentConverterï¼š

```csharp
using GameFrameX.Foundation.Options;

// åˆ›å»ºè½¬æ¢å™¨å®ä¾‹
var converter = new CommandLineArgumentConverter();

// åŸå§‹å‘½ä»¤è¡Œå‚æ•°
var args = new[] { "--port", "8080", "-h", "localhost" };

// è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
Environment.SetEnvironmentVariable("APP_NAME", "MyApplication");
Environment.SetEnvironmentVariable("LOG_LEVEL", "debug-mode");

// è½¬æ¢ä¸ºæ ‡å‡†æ ¼å¼ï¼ˆåˆå¹¶å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡ï¼‰
var standardArgs = converter.ConvertToStandardFormat(args);
// ç»“æœ: ["--port", "8080", "-h", "localhost", "--APP_NAME", "MyApplication", "--LOG_LEVEL", "debugmode"]

// è½¬æ¢ä¸ºå‘½ä»¤è¡Œå­—ç¬¦ä¸²
var commandLineString = converter.ToCommandLineString(standardArgs);
// ç»“æœ: "--port 8080 -h localhost --APP_NAME MyApplication --LOG_LEVEL debugmode"

// è·å–æ‰€æœ‰ç¯å¢ƒå˜é‡
var envVars = converter.GetEnvironmentVariables();
Console.WriteLine($"æ£€æµ‹åˆ° {envVars.Count} ä¸ªç¯å¢ƒå˜é‡");
```

##### å¸ƒå°”ç±»å‹å‚æ•°æ”¯æŒ

`CommandLineArgumentConverter` æ”¯æŒæ™ºèƒ½è¯†åˆ«å’Œå¤„ç†å¸ƒå°”ç±»å‹å‚æ•°ï¼Œæä¾›ä¸‰ç§æ ¼å¼ï¼š

```csharp
using GameFrameX.Foundation.Options;

// è®¾ç½®å¸ƒå°”ç±»å‹ç¯å¢ƒå˜é‡
Environment.SetEnvironmentVariable("ENABLE_LOGGING", "true");
Environment.SetEnvironmentVariable("DEBUG_MODE", "false");
Environment.SetEnvironmentVariable("VERBOSE", "yes");

var converter = new CommandLineArgumentConverter();

// 1. æ ‡å¿—æ ¼å¼ (é»˜è®¤) - åªä¸º true å€¼æ·»åŠ æ ‡å¿—
converter.BoolFormat = BoolArgumentFormat.Flag;
var flagArgs = converter.ConvertToStandardFormat(Array.Empty<string>());
// ç»“æœ: ["--ENABLE_LOGGING", "--VERBOSE"] (åªåŒ…å« true å€¼)

// 2. é”®å€¼å¯¹æ ¼å¼ - æ·»åŠ é”®å€¼å¯¹
converter.BoolFormat = BoolArgumentFormat.KeyValue;
var keyValueArgs = converter.ConvertToStandardFormat(Array.Empty<string>());
// ç»“æœ: ["--ENABLE_LOGGING", "true", "--DEBUG_MODE", "false", "--VERBOSE", "true"]

// 3. åˆ†ç¦»æ ¼å¼ - é”®å’Œå€¼åˆ†å¼€
converter.BoolFormat = BoolArgumentFormat.Separated;
var separatedArgs = converter.ConvertToStandardFormat(Array.Empty<string>());
// ç»“æœ: ["--ENABLE_LOGGING", "true", "--DEBUG_MODE", "false", "--VERBOSE", "true"]
```

æ”¯æŒçš„å¸ƒå°”å€¼æ ¼å¼ï¼š

- **True å€¼**: `"true"`, `"1"`, `"yes"`, `"on"`, `"enabled"` (ä¸åŒºåˆ†å¤§å°å†™)
- **False å€¼**: `"false"`, `"0"`, `"no"`, `"off"`, `"disabled"` (ä¸åŒºåˆ†å¤§å°å†™)

### ğŸ› ï¸ é€šç”¨å·¥å…·ç±» (GameFrameX.Foundation.Utility)

æä¾›ä¸€ç³»åˆ—å®ç”¨çš„å·¥å…·ç±»ï¼ŒåŒ…å«æ§åˆ¶å°æ“ä½œã€ç¯å¢ƒç®¡ç†ã€æ—¶é—´å¤„ç†å’Œé›ªèŠ±IDç”Ÿæˆç­‰åŠŸèƒ½ã€‚

#### æ ¸å¿ƒç»„ä»¶æ¦‚è§ˆ

| ç»„ä»¶        | æ–‡ä»¶å                    | ä¸»è¦åŠŸèƒ½                      |
|-----------|------------------------|---------------------------|
| **æ§åˆ¶å°åŠ©æ‰‹** | `ConsoleHelper.cs`     | æ§åˆ¶å°Logoæ‰“å°å’Œæ ¼å¼åŒ–è¾“å‡º           |
| **ç¯å¢ƒåŠ©æ‰‹**  | `EnvironmentHelper.cs` | ç¯å¢ƒå˜é‡ç®¡ç†å’Œç¯å¢ƒç±»å‹å®šä¹‰             |
| **æ—¶é—´åŠ©æ‰‹**  | `TimerHelper.cs`       | Unixæ—¶é—´æˆ³å¤„ç†å’Œæ—¶é—´è½¬æ¢            |
| **é›ªèŠ±ID**  | `SnowFlakeIdHelper.cs` | åˆ†å¸ƒå¼å”¯ä¸€IDç”Ÿæˆå™¨ï¼ˆSnowflakeç®—æ³•å®ç°ï¼‰ |

#### æ§åˆ¶å°åŠ©æ‰‹åŠŸèƒ½

```csharp
using GameFrameX.Foundation.Utility;

// æ‰“å°åº”ç”¨ç¨‹åºLogo
ConsoleHelper.PrintLogo();
// è¾“å‡ºæ ¼å¼åŒ–çš„æ§åˆ¶å°Logoï¼Œç”¨äºåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶çš„å“ç‰Œå±•ç¤º
```

#### ç¯å¢ƒç®¡ç†åŠŸèƒ½

```csharp
using GameFrameX.Foundation.Utility;

// è·å–å½“å‰ç¯å¢ƒç±»å‹
string currentEnv = Environments.Development;
Console.WriteLine($"å½“å‰ç¯å¢ƒ: {currentEnv}");

// ç¯å¢ƒåˆ¤æ–­
if (Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") == Environments.Development)
{
    // å¼€å‘ç¯å¢ƒç‰¹å®šé€»è¾‘
    Console.WriteLine("è¿è¡Œåœ¨å¼€å‘ç¯å¢ƒ");
}
```

#### æ—¶é—´å¤„ç†åŠŸèƒ½

```csharp
using GameFrameX.Foundation.Utility;

// Unixæ—¶é—´æˆ³å¸¸é‡
DateTime epochLocal = TimerHelper.EpochLocal;   // æœ¬åœ°æ—¶åŒºçš„Unixçºªå…ƒæ—¶é—´
DateTime epochUtc = TimerHelper.EpochUtc;       // UTCæ—¶åŒºçš„Unixçºªå…ƒæ—¶é—´

// è·å–å½“å‰Unixæ—¶é—´æˆ³ï¼ˆç§’ï¼‰
long unixSeconds = TimerHelper.UnixTimeSeconds();
Console.WriteLine($"å½“å‰Unixæ—¶é—´æˆ³ï¼ˆç§’ï¼‰: {unixSeconds}");

// è·å–å½“å‰Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
long unixMilliseconds = TimerHelper.UnixTimeMilliseconds();
Console.WriteLine($"å½“å‰Unixæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰: {unixMilliseconds}");

// æ—¶é—´æˆ³è½¬æ¢ç¤ºä¾‹
DateTime currentTime = DateTime.UtcNow;
long timestamp = ((DateTimeOffset)currentTime).ToUnixTimeSeconds();
DateTime restored = DateTimeOffset.FromUnixTimeSeconds(timestamp).DateTime;
```

#### é›ªèŠ±IDç”Ÿæˆå™¨

```csharp
using GameFrameX.Foundation.Utility;

// ä½¿ç”¨é»˜è®¤é…ç½®ç”ŸæˆID
long id1 = SnowFlakeIdHelper.GenerateId();
long id2 = SnowFlakeIdHelper.GenerateId();
Console.WriteLine($"ç”Ÿæˆçš„ID: {id1}, {id2}");

// é…ç½®å·¥ä½œèŠ‚ç‚¹IDå’Œæ•°æ®ä¸­å¿ƒID
SnowFlakeIdHelper.WorkId = 1;        // å·¥ä½œèŠ‚ç‚¹ID (0-31)
SnowFlakeIdHelper.DataCenterId = 1;  // æ•°æ®ä¸­å¿ƒID (0-31)

// ç”Ÿæˆé…ç½®åçš„ID
long configuredId = SnowFlakeIdHelper.GenerateId();
Console.WriteLine($"é…ç½®åçš„ID: {configuredId}");

// è·å–æ—¶é—´æˆ³ç›¸å…³ä¿¡æ¯
DateTime utcStart = SnowFlakeIdHelper.UtcTimeStart;  // UTCèµ·å§‹æ—¶é—´
long epochTime = SnowFlakeIdHelper.EpochTime;        // çºªå…ƒæ—¶é—´æˆ³

Console.WriteLine($"é›ªèŠ±IDèµ·å§‹æ—¶é—´: {utcStart}");
Console.WriteLine($"çºªå…ƒæ—¶é—´æˆ³: {epochTime}");
```

##### é›ªèŠ±IDç®—æ³•è¯´æ˜

é›ªèŠ±IDï¼ˆSnowflakeï¼‰æ˜¯Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- **å…¨å±€å”¯ä¸€**: åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ä¿è¯IDçš„å…¨å±€å”¯ä¸€æ€§
- **è¶‹åŠ¿é€’å¢**: ç”Ÿæˆçš„IDå¤§è‡´æŒ‰æ—¶é—´é€’å¢ï¼Œæœ‰åˆ©äºæ•°æ®åº“ç´¢å¼•
- **é«˜æ€§èƒ½**: å•æœºæ¯ç§’å¯ç”Ÿæˆæ•°ç™¾ä¸‡ä¸ªID
- **æ— ä¾èµ–**: ä¸ä¾èµ–æ•°æ®åº“æˆ–å…¶ä»–å¤–éƒ¨ç³»ç»Ÿ

IDç»“æ„ï¼ˆ64ä½ï¼‰ï¼š

```
0 - 0000000000 0000000000 0000000000 0000000000 0 - 00000 - 00000 - 000000000000
|   |                                             |   |       |       |
|   |<-------------- 41ä½æ—¶é—´æˆ³ ---------------->|   |<-5ä½->|<-5ä½->|<--12ä½-->
|                                                 |           |       |
ç¬¦å·ä½(1ä½)                                        |      æ•°æ®ä¸­å¿ƒID   åºåˆ—å·
                                                  |      (5ä½)      (12ä½)
                                               å·¥ä½œèŠ‚ç‚¹ID
                                                (5ä½)
```

- **1ä½ç¬¦å·ä½**: å›ºå®šä¸º0
- **41ä½æ—¶é—´æˆ³**: ç²¾ç¡®åˆ°æ¯«ç§’ï¼Œå¯ä½¿ç”¨çº¦69å¹´
- **5ä½æ•°æ®ä¸­å¿ƒID**: æ”¯æŒ32ä¸ªæ•°æ®ä¸­å¿ƒ
- **5ä½å·¥ä½œèŠ‚ç‚¹ID**: æ¯ä¸ªæ•°æ®ä¸­å¿ƒæ”¯æŒ32ä¸ªå·¥ä½œèŠ‚ç‚¹
- **12ä½åºåˆ—å·**: åŒä¸€æ¯«ç§’å†…æ”¯æŒ4096ä¸ªID

#### å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

```csharp
using GameFrameX.Foundation.Utility;

namespace MyApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            // æ‰“å°åº”ç”¨ç¨‹åºLogo
            ConsoleHelper.PrintLogo();
            
            // æ£€æŸ¥è¿è¡Œç¯å¢ƒ
            string env = Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") ?? Environments.Development;
            Console.WriteLine($"å½“å‰è¿è¡Œç¯å¢ƒ: {env}");
            
            // é…ç½®é›ªèŠ±IDç”Ÿæˆå™¨
            SnowFlakeIdHelper.WorkId = 1;
            SnowFlakeIdHelper.DataCenterId = 1;
            
            // ç”Ÿæˆå”¯ä¸€ID
            for (int i = 0; i < 5; i++)
            {
                long id = SnowFlakeIdHelper.GenerateId();
                long timestamp = TimerHelper.UnixTimeMilliseconds();
                
                Console.WriteLine($"ID: {id}, æ—¶é—´æˆ³: {timestamp}");
                
                // çŸ­æš‚å»¶è¿Ÿä»¥è§‚å¯ŸIDå˜åŒ–
                Thread.Sleep(1);
            }
            
            // æ—¶é—´å¤„ç†ç¤ºä¾‹
            Console.WriteLine($"Unixçºªå…ƒæ—¶é—´(UTC): {TimerHelper.EpochUtc}");
            Console.WriteLine($"Unixçºªå…ƒæ—¶é—´(æœ¬åœ°): {TimerHelper.EpochLocal}");
            Console.WriteLine($"å½“å‰Unixæ—¶é—´æˆ³(ç§’): {TimerHelper.UnixTimeSeconds()}");
            Console.WriteLine($"å½“å‰Unixæ—¶é—´æˆ³(æ¯«ç§’): {TimerHelper.UnixTimeMilliseconds()}");
        }
    }
}
```

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿ä»£ç è´¨é‡å’ŒåŠŸèƒ½æ­£ç¡®æ€§ã€‚æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•è¦†ç›–ç‡è¾¾åˆ°95%ä»¥ä¸Šã€‚

### æµ‹è¯•è¦†ç›–èŒƒå›´

#### ğŸ§© æ‰©å±•æ–¹æ³•åº“æµ‹è¯• (Extensions)

- **ArgumentAlreadyExceptionTests**: å‚æ•°å·²å­˜åœ¨å¼‚å¸¸æµ‹è¯•
- **BidirectionalDictionaryTests**: åŒå‘å­—å…¸åŠŸèƒ½æµ‹è¯•
- **ByteExtensionTests**: å­—èŠ‚æ•°ç»„æ‰©å±•æ–¹æ³•æµ‹è¯•
- **CollectionExtensionsTests**: é›†åˆæ‰©å±•æ–¹æ³•æµ‹è¯•
- **ConcurrentLimitedQueueTests**: å¹¶å‘é™åˆ¶é˜Ÿåˆ—æµ‹è¯•
- **DisposableConcurrentDictionaryTests**: å¯é‡Šæ”¾å¹¶å‘å­—å…¸æµ‹è¯•
- **DisposableDictionaryTests**: å¯é‡Šæ”¾å­—å…¸æµ‹è¯•
- **IDictionaryExtensionsTests**: å­—å…¸æ‰©å±•æ–¹æ³•æµ‹è¯•
- **IEnumerableExtensionsTests**: æšä¸¾æ‰©å±•æ–¹æ³•æµ‹è¯•
- **ListExtensionsTests**: åˆ—è¡¨æ‰©å±•æ–¹æ³•æµ‹è¯•
- **LookupXTests**: æŸ¥æ‰¾è¡¨åŠŸèƒ½æµ‹è¯•
- **NullObjectTests**: ç©ºå¯¹è±¡æ¨¡å¼æµ‹è¯•
- **NullableConcurrentDictionaryTests**: å¯ç©ºå¹¶å‘å­—å…¸æµ‹è¯•
- **NullableDictionaryTests**: å¯ç©ºå­—å…¸æµ‹è¯•
- **ObjectExtensionsTests**: å¯¹è±¡æ‰©å±•æ–¹æ³•æµ‹è¯•
- **ReadOnlySpanExtensionsTests**: åªè¯»Spanæ‰©å±•æµ‹è¯•
- **SequenceReaderExtensionsTests**: åºåˆ—è¯»å–å™¨æ‰©å±•æµ‹è¯•
- **SpanExtensionsTests**: Spanæ‰©å±•æ–¹æ³•æµ‹è¯•
- **StringExtensionsTests**: å­—ç¬¦ä¸²æ‰©å±•æ–¹æ³•æµ‹è¯•
- **TypeExtensionsTests**: ç±»å‹æ‰©å±•æ–¹æ³•æµ‹è¯•

#### ğŸ” åŠ å¯†å·¥å…·åº“æµ‹è¯• (Encryption)

- **AesHelperTests**: AESåŠ å¯†ç®—æ³•æµ‹è¯•
- **DsaHelperTests**: DSAæ•°å­—ç­¾åæµ‹è¯•
- **RsaHelperTests**: RSAåŠ å¯†ç®—æ³•æµ‹è¯•
- **Sm2HelperTests**: SM2å›½å¯†ç®—æ³•æµ‹è¯•
- **Sm4HelperTests**: SM4å›½å¯†ç®—æ³•æµ‹è¯•
- **XorHelperTests**: XORå¼‚æˆ–åŠ å¯†æµ‹è¯•

#### ğŸŒ æœ¬åœ°åŒ–æ¡†æ¶æµ‹è¯• (Localization)

- **LocalizationServiceTests**: æœ¬åœ°åŒ–æœåŠ¡æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
  - å•ä¾‹æ¨¡å¼éªŒè¯æµ‹è¯•
  - æœ¬åœ°åŒ–å­—ç¬¦ä¸²è·å–æµ‹è¯•
  - å‚æ•°åŒ–æ¶ˆæ¯æ ¼å¼åŒ–æµ‹è¯•
  - æœªçŸ¥é”®å¤„ç†æµ‹è¯•
  - çº¿ç¨‹å®‰å…¨å¹¶å‘æµ‹è¯•
- **ResourceManagerTests**: èµ„æºç®¡ç†å™¨æµ‹è¯•
  - æä¾›è€…ä¼˜å…ˆçº§æµ‹è¯•
  - æ‡’åŠ è½½æœºåˆ¶æµ‹è¯•
  - ç»Ÿè®¡ä¿¡æ¯éªŒè¯æµ‹è¯•
- **DefaultResourceProviderTests**: é»˜è®¤èµ„æºæä¾›è€…æµ‹è¯•
- **AssemblyResourceProviderTests**: ç¨‹åºé›†èµ„æºæä¾›è€…æµ‹è¯•
  - .resxæ–‡ä»¶åŠ è½½æµ‹è¯•
  - å¤šæ–‡åŒ–æ”¯æŒæµ‹è¯•
  - èµ„æºç¼“å­˜æœºåˆ¶æµ‹è¯•

#### ğŸ”— å“ˆå¸Œå·¥å…·åº“æµ‹è¯• (Hash)

- **CrcHelperTests**: CRCæ ¡éªŒç®—æ³•æµ‹è¯•
- **HmacSha256HelperTests**: HMAC-SHA256æµ‹è¯•
- **Md5HelperTests**: MD5å“ˆå¸Œç®—æ³•æµ‹è¯•
- **MurmurHash3HelperTests**: MurmurHash3ç®—æ³•æµ‹è¯•
- **Sha1HelperTests**: SHA-1å“ˆå¸Œç®—æ³•æµ‹è¯•
- **Sha256HelperTests**: SHA-256å“ˆå¸Œç®—æ³•æµ‹è¯•
- **Sha512HelperTests**: SHA-512å“ˆå¸Œç®—æ³•æµ‹è¯•
- **XxHashHelperTests**: xxHashé«˜æ€§èƒ½å“ˆå¸Œæµ‹è¯•

#### ğŸŒ HTTPå·¥å…·åº“æµ‹è¯• (Http.Extension)

- **HttpExtensionTests**: HTTPå®¢æˆ·ç«¯æ‰©å±•æ–¹æ³•æµ‹è¯•

#### âš™ï¸ å‘½ä»¤è¡Œå‚æ•°å¤„ç†æµ‹è¯• (Options)

- **CommandLineArgumentConverterTests**: å‘½ä»¤è¡Œå‚æ•°è½¬æ¢å™¨åŠŸèƒ½æµ‹è¯•
    - ç©ºå‚æ•°æ•°ç»„å¤„ç†æµ‹è¯•
    - ç©ºå‚æ•°å€¼å¤„ç†æµ‹è¯•
    - é‡å¤å‚æ•°æ£€æµ‹æµ‹è¯•
    - ç¯å¢ƒå˜é‡è½¬æ¢æµ‹è¯•
    - å€¼æ¸…ç†åŠŸèƒ½æµ‹è¯•
    - å•è¿å­—ç¬¦å‚æ•°è½¬æ¢æµ‹è¯•
    - å‘½ä»¤è¡Œå­—ç¬¦ä¸²ç”Ÿæˆæµ‹è¯•
    - ç¯å¢ƒå˜é‡è·å–æµ‹è¯•
    - å®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•
    - å¸ƒå°”ç±»å‹å‚æ•°å¤„ç†æµ‹è¯•
        - æ ‡å¿—æ ¼å¼å¸ƒå°”å‚æ•°æµ‹è¯•
        - é”®å€¼å¯¹æ ¼å¼å¸ƒå°”å‚æ•°æµ‹è¯•
        - åˆ†ç¦»æ ¼å¼å¸ƒå°”å‚æ•°æµ‹è¯•
        - å¤šç§å¸ƒå°”å€¼æ ¼å¼è§£ææµ‹è¯•
        - éå¸ƒå°”å€¼å¤„ç†æµ‹è¯•
- **OptionsBuilderTests**: é€‰é¡¹æ„å»ºå™¨åŠŸèƒ½æµ‹è¯•
    - åŸºæœ¬é…ç½®æ„å»ºæµ‹è¯•
    - ç‰¹æ€§é…ç½®æµ‹è¯•
    - ç±»å‹è½¬æ¢æµ‹è¯•
    - éªŒè¯åŠŸèƒ½æµ‹è¯•
- **OptionsProviderTests**: é€‰é¡¹æä¾›å™¨åŠŸèƒ½æµ‹è¯•
    - é…ç½®æ³¨å†Œå’Œè·å–æµ‹è¯•
    - å…¨å±€é…ç½®ç®¡ç†æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
dotnet test

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
dotnet test --filter "FullyQualifiedName~Extensions"
dotnet test --filter "FullyQualifiedName~Encryption"
dotnet test --filter "FullyQualifiedName~Hash"
dotnet test --filter "FullyQualifiedName~Localization"
dotnet test --filter "FullyQualifiedName~Options"

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
dotnet test --filter "ClassName=XxHashHelperTests"
dotnet test --filter "ClassName=StringExtensionsTests"
dotnet test --filter "ClassName=LocalizationServiceTests"
dotnet test --filter "ClassName=CommandLineArgumentConverterTests"

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
dotnet test --collect:"XPlat Code Coverage"

# è¿è¡Œæ€§èƒ½æµ‹è¯•
dotnet test --filter "Category=Performance"
```

### æµ‹è¯•ç‰¹ç‚¹

- **å…¨é¢è¦†ç›–**: æ¯ä¸ªå…¬å…±æ–¹æ³•éƒ½æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹
- **è¾¹ç•Œæµ‹è¯•**: åŒ…å«ç©ºå€¼ã€è¾¹ç•Œå€¼ã€å¼‚å¸¸æƒ…å†µçš„æµ‹è¯•
- **æ€§èƒ½æµ‹è¯•**: å¯¹å…³é”®ç®—æ³•è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
- **å¹¶å‘æµ‹è¯•**: éªŒè¯çº¿ç¨‹å®‰å…¨çš„ç»„ä»¶åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ­£ç¡®æ€§
- **å…¼å®¹æ€§æµ‹è¯•**: ç¡®ä¿åœ¨ä¸åŒ.NETç‰ˆæœ¬ä¸‹çš„å…¼å®¹æ€§

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### è®¾è®¡åŸåˆ™

- **é«˜æ€§èƒ½**: æ‰€æœ‰ç»„ä»¶éƒ½ç»è¿‡æ€§èƒ½ä¼˜åŒ–ï¼Œé€‚ç”¨äºé«˜å¹¶å‘åœºæ™¯
- **æ˜“ç”¨æ€§**: æä¾›ç®€æ´çš„ API è®¾è®¡ï¼Œé™ä½å­¦ä¹ æˆæœ¬
- **å¯æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒè‡ªå®šä¹‰æ‰©å±•
- **ç±»å‹å®‰å…¨**: å……åˆ†åˆ©ç”¨ .NET çš„ç±»å‹ç³»ç»Ÿï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
- **å†…å­˜å‹å¥½**: ä½¿ç”¨ Span<T> å’Œ Memory<T> ç­‰ç°ä»£ .NET ç‰¹æ€§ï¼Œå‡å°‘å†…å­˜åˆ†é…

### ä¾èµ–å…³ç³»

```
GameFrameX.Foundation.Extensions (æ ¸å¿ƒæ‰©å±•)
â”œâ”€â”€ GameFrameX.Foundation.Encryption (åŠ å¯†å·¥å…·)
â”œâ”€â”€ GameFrameX.Foundation.Hash (å“ˆå¸Œå·¥å…·)
â”œâ”€â”€ GameFrameX.Foundation.Json (JSONå·¥å…·)
â”œâ”€â”€ GameFrameX.Foundation.Logger (æ—¥å¿—å·¥å…·)
â”œâ”€â”€ GameFrameX.Foundation.Options (å‚æ•°å¤„ç†)
â”œâ”€â”€ GameFrameX.Foundation.Http.Extension (HTTPæ‰©å±•)
â””â”€â”€ GameFrameX.Foundation.Http.Normalization (HTTPæ ‡å‡†åŒ–)
```

## ğŸ”§ å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- .NET 10.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- C# 12.0 æˆ–æ›´é«˜ç‰ˆæœ¬

### æ„å»ºé¡¹ç›®

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/GameFrameX/GameFrameX.Foundation.git
cd GameFrameX.Foundation

# è¿˜åŸä¾èµ–
dotnet restore

# æ„å»ºé¡¹ç›®
dotnet build

# è¿è¡Œæµ‹è¯•
dotnet test
```

### è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“Š æ€§èƒ½åŸºå‡†

### æ‰©å±•æ–¹æ³•æ€§èƒ½

| æ“ä½œ        | ä¼ ç»Ÿæ–¹æ³•  | æ‰©å±•æ–¹æ³•  | æ€§èƒ½æå‡ |
|-----------|-------|-------|------|
| å­—ç¬¦ä¸²ç©ºå€¼æ£€æŸ¥   | 100ns | 15ns  | 85%  |
| é›†åˆéšæœºå…ƒç´ è·å–  | 200ns | 50ns  | 75%  |
| Span å­—èŠ‚æ“ä½œ | 500ns | 80ns  | 84%  |
| åŒå‘å­—å…¸æŸ¥æ‰¾    | 150ns | 120ns | 20%  |

### åŠ å¯†ç®—æ³•æ€§èƒ½

| ç®—æ³•       | æ•°æ®å¤§å° | åŠ å¯†æ—¶é—´   | è§£å¯†æ—¶é—´   |
|----------|------|--------|--------|
| AES-256  | 1KB  | 0.05ms | 0.04ms |
| RSA-2048 | 1KB  | 2.1ms  | 0.8ms  |
| SM4      | 1KB  | 0.08ms | 0.07ms |
| XOR      | 1KB  | 0.01ms | 0.01ms |

### å“ˆå¸Œç®—æ³•æ€§èƒ½

| ç®—æ³•          | æ•°æ®å¤§å° | å¤„ç†æ—¶é—´  | ååé‡      |
|-------------|------|-------|----------|
| MD5         | 1MB  | 2.1ms | 476MB/s  |
| SHA-256     | 1MB  | 3.8ms | 263MB/s  |
| xxHash64    | 1MB  | 0.8ms | 1.25GB/s |
| MurmurHash3 | 1MB  | 1.2ms | 833MB/s  |

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- .NET 10.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- æ”¯æŒ Windowsã€Linuxã€macOS

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›é¡¹ç›®ã€‚

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ¤ ç¤¾åŒºæ”¯æŒ

- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/GameFrameX/GameFrameX.Foundation/issues)
- **åŠŸèƒ½è¯·æ±‚**: [GitHub Discussions](https://github.com/GameFrameX/GameFrameX.Foundation/discussions)
- **æ–‡æ¡£è´¡çŒ®**: æ¬¢è¿æäº¤æ–‡æ¡£æ”¹è¿›çš„ PR

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸º GameFrameX.Foundation åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ä»¬ï¼

## ğŸ”— ç›¸å…³é“¾æ¥

- [GameFrameX å®˜ç½‘](https://gameframex.doc.alianblank.com)
- [æ–‡æ¡£ä¸­å¿ƒ](https://gameframex.doc.alianblank.com)
- [é—®é¢˜åé¦ˆ](https://github.com/GameFrameX/GameFrameX.Foundation/issues)

---

<div align="center">

**[â¬† å›åˆ°é¡¶éƒ¨](#gamefamex-foundation)**

Made with â¤ï¸ by GameFrameX Team

</div>
